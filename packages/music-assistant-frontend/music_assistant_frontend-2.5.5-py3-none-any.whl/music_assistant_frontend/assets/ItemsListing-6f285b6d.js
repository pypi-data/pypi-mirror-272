import{aj as ee,ak as se,l as q,m as H,z as L,al as _e,D as $e,A as Ae,am as Fe,an as dt,f as y,E as z,v as ct,H as ft,r as O,d as te,c as n,e as b,u as g,a8 as U,b as Oe,a5 as Pe,ao as j,g as S,w as u,i as R,t as h,Y as $,j as p,_ as ne,M as E,ap as vt,X as Z,R as pt,Q as yt,a as ge,s as D,N as Y,o as ht,U as ke,aq as bt,ah as gt,F as kt,h as wt}from"./index-1ade6d75.js";import{M as Le,k as Ne,r as Te,c as x,v as Me,f as St,m as re,w as It,s as Ct,p as Vt}from"./utils-2d720fc5.js";import{_ as Bt}from"./eventbus-c99d57ba.js";import{L as _t}from"./ListItem-d34b27e3.js";import{B as De}from"./Button-bfd0a979.js";import{m as $t,a as we,V as At}from"./VTextField-843c6466.js";import{m as Ft,u as Ot,a as Se,V as Pt}from"./VVirtualScroll-9d344e9f.js";import{m as ue,b as me,c as Ee,h as Lt,o as Nt,t as Tt,v as Mt,w as K,C as Dt,V as Et,A as Rt,B as Q,x as jt,s as Ie}from"./VListItem-36c0aa4e.js";import{e as Gt,g as Kt,b as le,f as Ut}from"./VMenu-707b430f.js";import{_ as de}from"./_plugin-vue_export-helper-c27b6911.js";import{b as zt,V as Ht}from"./VCard-880c9ffc.js";import{V as Wt}from"./VSpacer-670f4f07.js";import{A as Ce}from"./Alert-ce217d13.js";import{C as Yt}from"./Container-d31ab87d.js";import{T as qt}from"./Toolbar-5b1de6c4.js";import{V as Xt}from"./VList-1f0ef080.js";import{a as Jt,V as Qt}from"./VInfiniteScroll-b9f6a02b.js";/* empty css              */const Re=(()=>ee.reduce((o,v)=>(o[v]={type:[Boolean,String,Number],default:!1},o),{}))(),je=(()=>ee.reduce((o,v)=>{const a="offset"+se(v);return o[a]={type:[String,Number],default:null},o},{}))(),Ge=(()=>ee.reduce((o,v)=>{const a="order"+se(v);return o[a]={type:[String,Number],default:null},o},{}))(),Ve={col:Object.keys(Re),offset:Object.keys(je),order:Object.keys(Ge)};function Zt(o,v,a){let r=o;if(!(a==null||a===!1)){if(v){const l=v.replace(o,"");r+=`-${l}`}return o==="col"&&(r="v-"+r),o==="col"&&(a===""||a===!0)||(r+=`-${a}`),r.toLowerCase()}}const xt=["auto","start","end","center","baseline","stretch"],ea=q({cols:{type:[Boolean,String,Number],default:!1},...Re,offset:{type:[String,Number],default:null},...je,order:{type:[String,Number],default:null},...Ge,alignSelf:{type:String,default:null,validator:o=>xt.includes(o)},...ue(),...me()},"VCol"),ta=H()({name:"VCol",props:ea(),setup(o,v){let{slots:a}=v;const r=L(()=>{const l=[];let d;for(d in Ve)Ve[d].forEach(w=>{const e=o[w],c=Zt(d,w,e);c&&l.push(c)});const k=l.some(w=>w.startsWith("v-col-"));return l.push({"v-col":!k||!o.cols,[`v-col-${o.cols}`]:o.cols,[`offset-${o.offset}`]:o.offset,[`order-${o.order}`]:o.order,[`align-self-${o.alignSelf}`]:o.alignSelf}),l});return()=>{var l;return _e(o.tag,{class:[r.value,o.class],style:o.style},(l=a.default)==null?void 0:l.call(a))}}}),ce=["start","end","center"],Ke=["space-between","space-around","space-evenly"];function fe(o,v){return ee.reduce((a,r)=>{const l=o+se(r);return a[l]=v(),a},{})}const aa=[...ce,"baseline","stretch"],Ue=o=>aa.includes(o),ze=fe("align",()=>({type:String,default:null,validator:Ue})),oa=[...ce,...Ke],He=o=>oa.includes(o),We=fe("justify",()=>({type:String,default:null,validator:He})),la=[...ce,...Ke,"stretch"],Ye=o=>la.includes(o),qe=fe("alignContent",()=>({type:String,default:null,validator:Ye})),Be={align:Object.keys(ze),justify:Object.keys(We),alignContent:Object.keys(qe)},ia={align:"align",justify:"justify",alignContent:"align-content"};function sa(o,v,a){let r=ia[o];if(a!=null){if(v){const l=v.replace(o,"");r+=`-${l}`}return r+=`-${a}`,r.toLowerCase()}}const na=q({dense:Boolean,noGutters:Boolean,align:{type:String,default:null,validator:Ue},...ze,justify:{type:String,default:null,validator:He},...We,alignContent:{type:String,default:null,validator:Ye},...qe,...ue(),...me()},"VRow"),ra=H()({name:"VRow",props:na(),setup(o,v){let{slots:a}=v;const r=L(()=>{const l=[];let d;for(d in Be)Be[d].forEach(k=>{const w=o[k],e=sa(d,k,w);e&&l.push(e)});return l.push({"v-row--no-gutters":o.noGutters,"v-row--dense":o.dense,[`align-${o.align}`]:o.align,[`justify-${o.justify}`]:o.justify,[`align-content-${o.alignContent}`]:o.alignContent}),l});return()=>{var l;return _e(o.tag,{class:["v-row",r.value,o.class],style:o.style},(l=a.default)==null?void 0:l.call(a))}}});const ua=q({...Ft(),...$e($t(),["inline"])},"VCheckbox"),Xe=H()({name:"VCheckbox",inheritAttrs:!1,props:ua(),emits:{"update:modelValue":o=>!0,"update:focused":o=>!0},setup(o,v){let{attrs:a,slots:r}=v;const l=Ae(o,"modelValue"),{isFocused:d,focus:k,blur:w}=Ot(o),e=Fe(),c=L(()=>o.id||`checkbox-${e}`);return Ee(()=>{const[I,C]=dt(a),B=Se.filterProps(o),P=we.filterProps(o);return y(Se,z({class:["v-checkbox",o.class]},I,B,{modelValue:l.value,"onUpdate:modelValue":_=>l.value=_,id:c.value,focused:d.value,style:o.style}),{...r,default:_=>{let{id:A,messagesId:G,isDisabled:ae,isReadonly:oe,isValid:X}=_;return y(we,z(P,{id:A.value,"aria-describedby":G.value,disabled:ae.value,readonly:oe.value},C,{error:X.value===!1,modelValue:l.value,"onUpdate:modelValue":J=>l.value=J,onFocus:k,onBlur:w}),r)}})}),{}}});const Je=Symbol.for("vuetify:v-item-group"),ma=q({...ue(),...Lt({selectedClass:"v-item--selected"}),...me(),...ct()},"VItemGroup"),Qe=H()({name:"VItemGroup",props:ma(),emits:{"update:modelValue":o=>!0},setup(o,v){let{slots:a}=v;const{themeClasses:r}=ft(o),{isSelected:l,select:d,next:k,prev:w,selected:e}=Nt(o,Je);return()=>y(o.tag,{class:["v-item-group",r.value,o.class],style:o.style},{default:()=>{var c;return[(c=a.default)==null?void 0:c.call(a,{isSelected:l,select:d,next:k,prev:w,selected:e.value})]}})}}),M=H()({name:"VItem",props:Tt(),emits:{"group:selected":o=>!0},setup(o,v){let{slots:a}=v;const{isSelected:r,select:l,toggle:d,selectedClass:k,value:w,disabled:e}=Mt(o,Je);return()=>{var c;return(c=a.default)==null?void 0:c.call(a,{isSelected:r.value,selectedClass:k.value,select:l,toggle:d,value:w.value,disabled:e.value})}}});const da=q({id:String,text:String,...$e(Gt({closeOnBack:!1,location:"end",locationStrategy:"connected",eager:!0,minWidth:0,offset:10,openOnClick:!1,openOnHover:!0,origin:"auto",scrim:!1,scrollStrategy:"reposition",transition:!1}),["absolute","persistent"])},"VTooltip"),ie=H()({name:"VTooltip",props:da(),emits:{"update:modelValue":o=>!0},setup(o,v){let{slots:a}=v;const r=Ae(o,"modelValue"),{scopeId:l}=Kt(),d=Fe(),k=L(()=>o.id||`v-tooltip-${d}`),w=O(),e=L(()=>o.location.split(" ").length>1?o.location:o.location+" center"),c=L(()=>o.origin==="auto"||o.origin==="overlap"||o.origin.split(" ").length>1||o.location.split(" ").length>1?o.origin:o.origin+" center"),I=L(()=>o.transition?o.transition:r.value?"scale-transition":"fade-transition"),C=L(()=>z({"aria-describedby":k.value},o.activatorProps));return Ee(()=>{const B=le.filterProps(o);return y(le,z({ref:w,class:["v-tooltip",o.class],style:o.style,id:k.value},B,{modelValue:r.value,"onUpdate:modelValue":P=>r.value=P,transition:I.value,absolute:!0,location:e.value,origin:c.value,persistent:!0,role:"tooltip",activatorProps:C.value,_disableGlobalStack:!0},l),{activator:a.activator,default:function(){var G;for(var P=arguments.length,_=new Array(P),A=0;A<P;A++)_[A]=arguments[A];return((G=a.default)==null?void 0:G.call(a,..._))??o.text}})}),Ut({},w)}}),Ze=te({__name:"FavoriteButton",props:{item:{}},setup(o){const v=o;return(a,r)=>{var l;return n(),b(De,z(v,{variant:"list",icon:(l=a.item)!=null&&l.favorite?"mdi-heart":"mdi-heart-outline",title:a.$t("tooltip.favorite"),onClick:[r[0]||(r[0]=d=>g(Oe).toggleFavorite(a.item)),r[1]||(r[1]=U(()=>{},["prevent"])),r[2]||(r[2]=U(()=>{},["stop"]))]}),null,16,["icon","title"])}}}),ca={key:0,class:"media-thumb listitem-media-thumb"},fa={key:1,class:"media-thumb listitem-media-thumb"},va={key:0},pa={key:1},ya={key:0},ha={key:0,class:"line-clamp-1"},ba={key:1},ga={key:0},ka={key:1},wa={key:2},Sa={key:3},Ia={key:4},Ca={key:5},Va={key:2},Ba={key:3},_a={class:"text-caption",style:{"padding-right":"10px","padding-left":"10px"}},$a=te({__name:"ListviewItem",props:{item:{},showTrackNumber:{type:Boolean,default:!0},showDiscNumber:{type:Boolean,default:!0},showPosition:{type:Boolean,default:!0},showProvider:{type:Boolean,default:!0},showAlbum:{type:Boolean,default:!0},showMenu:{type:Boolean,default:!0},showFavorite:{type:Boolean,default:!1},showDuration:{type:Boolean,default:!0},isSelected:{type:Boolean},isDisabled:{type:Boolean,default:!1},showCheckboxes:{type:Boolean,default:!1},showDetails:{type:Boolean}},emits:["menu","click","select"],setup(o,{emit:v}){const{t:a}=Pe(),r=o,l=L(()=>{if(!("provider_mappings"in r.item))return"";for(const e of r.item.provider_mappings)if(e.audio_format&&e.audio_format.content_type!=null&&[j.DSF,j.FLAC,j.AIFF,j.WAV].includes(e.audio_format.content_type)&&(e.audio_format.sample_rate>48e3||e.audio_format.bit_depth>16))return`${e.audio_format.sample_rate/1e3}kHz ${e.audio_format.bit_depth} bits`;return""}),d=v,k=function(e){r.showCheckboxes||d("menu",e,r.item)},w=function(e){r.showCheckboxes||d("click",e,r.item)};return(e,c)=>(n(),S("div",null,[y(_t,{link:"",disabled:!g(re)(e.item)||e.isDisabled,"show-menu-btn":e.showMenu,onClick:U(w,["stop"]),onMenu:U(k,["stop"])},{prepend:u(()=>[e.showCheckboxes?(n(),S("div",ca,[y(Xe,{"model-value":e.isSelected,onClick:c[0]||(c[0]=U(()=>{},["stop"])),"onUpdate:modelValue":c[1]||(c[1]=I=>{I!=null&&d("select",e.item,I)})},null,8,["model-value"])])):(n(),S("div",fa,[y(Le,{size:"50",item:e.item},null,8,["item"])]))]),title:u(()=>[e.item.media_type==g(E).FOLDER?(n(),S("span",va,[R("span",null,h(g(Ne)(e.item,g(a))),1)])):(n(),S("span",pa,[$(h(e.item.name)+" ",1),"version"in e.item&&e.item.version?(n(),S("span",ya,"("+h(e.item.version)+")",1)):p("",!0)])),e.item&&e.item.metadata?(n(),b(g(ie),{key:2,location:"bottom"},{activator:u(({props:I})=>[g(Te)(e.item.metadata.explicit||!1)?(n(),b(K,z({key:0},I,{icon:"mdi-alpha-e-box",width:"35"}),null,16)):p("",!0)]),default:u(()=>[R("span",null,h(e.$t("tooltip.explicit")),1)]),_:1})):p("",!0)]),subtitle:u(()=>[e.item.media_type==g(E).TRACK&&"provider_mappings"in e.item?(n(),S("div",ha,[y(Qe,null,{default:u(()=>["artists"in e.item?(n(),b(M,{key:0},{default:u(()=>[$(h(g(x)(e.item.artists,2)),1)]),_:1})):p("",!0),e.showAlbum&&"album"in e.item&&e.item.album?(n(),b(M,{key:1},{default:u(()=>[$(" • "+h(e.item.album.name),1)]),_:1})):p("",!0),"disc_number"in e.item&&e.item.disc_number&&e.showDiscNumber?(n(),b(M,{key:2},{default:u(()=>[y(K,{style:{"margin-left":"5px"},icon:"md:album"}),$(" "+h(e.item.disc_number),1)]),_:1})):p("",!0),"track_number"in e.item&&e.item.track_number&&e.showTrackNumber?(n(),b(M,{key:3},{default:u(()=>[y(K,{style:{"margin-left":"5px"},icon:"mdi-music-circle-outline"}),$(" "+h(e.item.track_number),1)]),_:1})):"position"in e.item&&e.item.position&&e.showPosition?(n(),b(M,{key:4},{default:u(()=>[y(K,{style:{"margin-left":"5px"},icon:"mdi-music-circle-outline"}),$(" "+h(e.item.position),1)]),_:1})):p("",!0)]),_:1})])):e.item.media_type==g(E).ALBUM&&"year"in e.item?(n(),S("div",ba,[e.item.album_type!=g(vt).UNKNOWN?(n(),S("span",ga,h(e.$t("album_type."+e.item.album_type))+" • ",1)):p("",!0),R("span",null,h(g(x)(e.item.artists)),1),e.item.year?(n(),S("span",ka," • "+h(e.item.year),1)):p("",!0)])):"artists"in e.item&&e.item.artists?(n(),S("div",wa,h(g(x)(e.item.artists)),1)):"owner"in e.item&&e.item.owner?(n(),S("div",Sa,h(e.item.owner),1)):e.item.media_type==g(E).RADIO&&e.item.metadata.description?(n(),S("div",Ia,h(e.item.metadata.description),1)):"media_type"in e.item&&!e.item.provider_mappings?(n(),S("div",Ca,h(e.$t(e.item.media_type)),1)):p("",!0)]),append:u(()=>[l.value?(n(),b(Dt,{key:0,src:g(Me),width:"30",class:ne(e.$vuetify.theme.current.dark?"hiresicondark":"hiresicon")},{default:u(()=>[y(g(ie),{activator:"parent",location:"bottom"},{default:u(()=>[$(h(l.value),1)]),_:1})]),_:1},8,["src","class"])):p("",!0),g(Z)("bp2")&&e.showProvider?(n(),b(Bt,{key:1,domain:e.item.media_type==g(E).PLAYLIST?e.item.provider_mappings[0].provider_domain:e.item.provider,size:24},null,8,["domain"])):p("",!0),g(Z)("bp3")&&"favorite"in e.item&&e.showFavorite&&!e.$vuetify.display.mobile?(n(),S("div",Va,[y(Ze,{item:e.item},null,8,["item"])])):p("",!0),e.showDuration&&e.item.media_type==g(E).TRACK&&"duration"in e.item&&e.item.duration!=null&&g(Z)("bp0")?(n(),S("div",Ba,[R("div",null,[R("span",_a,h(g(St)(e.item.duration)),1)])])):p("",!0)]),_:1},8,["disabled","show-menu-btn"])]))}});const Aa=de($a,[["__scopeId","data-v-69fb0ad2"]]),Fa={key:0},Oa={key:1},Pa={key:2},La=["src"],Na={key:0},Ta=te({__name:"PanelviewItem",props:{item:{},size:{default:200},isSelected:{type:Boolean},showCheckboxes:{type:Boolean,default:!1},showMediaType:{type:Boolean,default:!1},showActions:{type:Boolean,default:!1}},emits:["menu","click","select"],setup(o,{emit:v}){const a=o,r=O(!1),l=L(()=>{for(const e of a.item.provider_mappings)if(e.audio_format&&e.audio_format.content_type!=null&&[j.DSF,j.FLAC,j.AIFF,j.WAV].includes(e.audio_format.content_type)&&(e.audio_format.sample_rate>48e3||e.audio_format.bit_depth>16))return`${e.audio_format.sample_rate/1e3}kHz ${e.audio_format.bit_depth} bits`;return""}),d=v,k=function(e){a.showCheckboxes||d("menu",e,a.item)},w=function(e){a.showCheckboxes||d("click",e,a.item)};return(e,c)=>{const I=pt("hold");return yt((n(),b(Ht,{tile:"",hover:"",class:"panel-item",disabled:!g(re)(e.item),onClick:w,onContextmenu:U(k,["right","prevent"]),onMouseover:c[2]||(c[2]=C=>r.value=!0),onMouseleave:c[3]||(c[3]=C=>r.value=!1)},{default:u(()=>[e.showCheckboxes?(n(),b(le,{key:0,"model-value":e.showCheckboxes,contained:"",scrim:e.isSelected?e.$vuetify.theme.current.dark?"rgba(0,0,0,.75)":"rgba(255,255,255,.75)":"#ffffff00",onClick:c[0]||(c[0]=C=>{d("select",e.item,!e.isSelected)})},{default:u(()=>[y(Xe,{class:"panel-item-checkbox",ripple:!1,"model-value":e.isSelected},null,8,["model-value"])]),_:1},8,["model-value","scrim"])):p("",!0),y(Le,{item:e.item,style:{height:"auto"}},null,8,["item"]),y(Et,{variant:"text",slim:"",tile:"",density:"compact",class:"panel-item-details"},{default:u(()=>[y(Rt,null,{default:u(()=>[e.item.media_type==g(E).FOLDER?(n(),S("span",Fa,[R("span",null,h(g(Ne)(e.item,e.$t)),1)])):(n(),S("span",Oa,h(e.item.name),1)),"version"in e.item&&e.item.version?(n(),S("span",Pa," - "+h(e.item.version),1)):p("",!0)]),_:1}),"artists"in e.item&&e.item.artists?(n(),b(Q,{key:0,class:"line-clamp-1"},{default:u(()=>[$(h(g(x)(e.item.artists,1)),1)]),_:1})):"owner"in e.item&&e.item.owner?(n(),b(Q,{key:1,class:"line-clamp-1"},{default:u(()=>[$(h(e.item.owner),1)]),_:1})):e.showMediaType?(n(),b(Q,{key:2,class:"line-clamp-1"},{default:u(()=>[$(h(e.$t(e.item.media_type)),1)]),_:1})):(n(),b(Q,{key:3,class:"line-clamp-1"}))]),_:1}),e.showActions?(n(),b(zt,{key:1,class:"panel-item-actions"},{default:u(()=>[y(Qe,{style:{padding:"0"}},{default:u(()=>[g(Te)(e.item.metadata.explicit||!1)?(n(),b(M,{key:0},{default:u(()=>[y(K,{size:"30",icon:"mdi-alpha-e-box"})]),_:1})):p("",!0),l.value?(n(),b(M,{key:1},{default:u(()=>[y(K,{class:ne(e.$vuetify.theme.current.dark?"hiresicon":"hiresiconinverted")},{default:u(()=>[R("img",{src:g(Me),width:"30"},null,8,La),y(ie,{activator:"parent",location:"bottom"},{default:u(()=>[$(h(l.value),1)]),_:1})]),_:1},8,["class"])]),_:1})):p("",!0),"track_number"in e.item&&e.item.track_number||"position"in e.item&&e.item.position?(n(),b(M,{key:2},{default:u(()=>[y(K,{size:"small",icon:"mdi-music-circle-outline"}),e.item.disc_number?(n(),S("span",Na,h(e.item.disc_number)+"/",1)):p("",!0),$(h(e.item.track_number||e.item.position),1)]),_:1})):p("",!0),g(Z)("bp3")?(n(),b(M,{key:3},{default:u(()=>[y(Ze,{item:e.item},null,8,["item"])]),_:1})):p("",!0)]),_:1}),y(Wt),r.value?(n(),b(De,{key:0,variant:"list",icon:"mdi-dots-vertical",style:{"padding-right":"0","margin-right":"-5px"},onClick:c[1]||(c[1]=U(C=>e.$emit("menu",C,e.item),["stop"]))})):p("",!0)]),_:1})):p("",!0)]),_:1},8,["disabled"])),[[I,k]])}}});const Ma=de(Ta,[["__scopeId","data-v-2ff5074d"]]),Da={key:0},Ea={key:1},Ra=te({__name:"ItemsListing",props:{itemtype:{},sortKeys:{default:()=>["name","sort_name"]},showTrackNumber:{type:Boolean,default:!0},showProvider:{type:Boolean,default:Object.keys(Oe.providers).length>1},showAlbum:{type:Boolean,default:!0},showMenu:{type:Boolean,default:!0},showFavoritesOnlyFilter:{type:Boolean,default:!0},showDuration:{type:Boolean,default:!0},parentItem:{default:void 0},showAlbumArtistsOnlyFilter:{type:Boolean},showSearchButton:{type:Boolean,default:void 0},showRefreshButton:{type:Boolean,default:void 0},showSelectButton:{type:Boolean,default:void 0},updateAvailable:{type:Boolean},title:{default:void 0},hideOnEmpty:{type:Boolean,default:!1},showLibraryOnlyFilter:{type:Boolean,default:!1},allowCollapse:{type:Boolean,default:!1},allowKeyHooks:{type:Boolean,default:!1},extraMenuItems:{default:void 0},loadPagedData:{type:Function,default:void 0},loadItems:{type:Function,default:void 0},limit:{default:50},infiniteScroll:{type:Boolean,default:!0},path:{default:void 0},icon:{default:void 0},restoreState:{type:Boolean,default:!1}},emits:["refreshClicked"],setup(o,{emit:v}){const a=o,r=gt(),l=O({offset:0,limit:50,sortBy:"name",search:"",libraryOnly:!1}),d=O("list"),k=O(!1),w=O(!1),e=O([]),c=O([]),I=O(),C=O(!1),B=O([]),P=O(!1),_=O(!1),A=O(!0),{t:G}=Pe(),ae=v,oe=function(){k.value?k.value=!1:(k.value=!0,ke(()=>{var t;(t=document.getElementById("searchInput"))==null||t.focus()}))},X=function(){A.value=!A.value,localStorage.setItem(`expand.${a.itemtype}`,A.value.toString())},J=function(t){d.value=t,localStorage.setItem(`viewMode.${a.itemtype}`,t)},xe=function(){l.value.favoritesOnly=!l.value.favoritesOnly;const t=l.value.favoritesOnly?"true":"false";localStorage.setItem(`favoriteFilter.${a.itemtype}`,t),N(!0)},et=function(){l.value.libraryOnly=!l.value.libraryOnly;const t=l.value.libraryOnly?"true":"false";localStorage.setItem(`libraryFilter.${a.itemtype}`,t),N(!0,void 0,!0)},tt=function(){l.value.albumArtistsFilter=!l.value.albumArtistsFilter;const t=l.value.albumArtistsFilter?"true":"false";localStorage.setItem(`albumArtistsFilter.${a.itemtype}`,t),N(!0)},ve=function(t){return B.value.includes(t)},pe=function(t,i){if(i)B.value.includes(t)||B.value.push(t);else for(let s=0;s<B.value.length;s++)B.value[s]===t&&B.value.splice(s,1)},at=function(){_.value&&(B.value=[]),_.value=!_.value},W=function(t,i){const s=Array.isArray(i)?i:[i];Ct(s,a.parentItem,t.clientX,t.clientY)},ot=function(){ae("refreshClicked"),N(!0,void 0,!0)},ye=function(t,i){if(!re(i)){W(t,i);return}i.media_type==E.FOLDER?r.push({name:"browse",query:{path:i.path}}):["artist","album","playlist"].includes(i.media_type)?r.push({name:i.media_type,params:{itemId:i.item_id,provider:i.provider}}):W(t,i)},lt=function(){l.value.search="",k.value=!1,N(!0)},it=function(t,i){t!==void 0&&(l.value.sortBy=t),localStorage.setItem(`sortBy.${a.itemtype}`,l.value.sortBy),N(!0,void 0,t=="original")},st=function(){D.globalSearchTerm=l.value.search,r.push({name:"search"})},nt=function({done:t}){if(e.value.length==0){t("empty");return}if(I.value&&e.value.length>=I.value){t("empty");return}t("loading"),l.value.offset+=a.limit,N().then(()=>{t("ok")})},he=L(()=>{var t=!1;return l.value.search&&l.value.search.length!==0&&(t=!0),t}),rt=L(()=>{var i,s;if(a.allowCollapse===!0&&!A.value)return[{label:"tooltip.collapse_expand",icon:"mdi-chevron-down",action:X,overflowAllowed:!1}];const t=[];return a.showSelectButton!==!1&&t.push({label:"tooltip.select_items",icon:_.value?"mdi-checkbox-multiple-outline":"mdi-checkbox-multiple-blank-outline",action:at,active:_.value}),a.showLibraryOnlyFilter===!0&&t.push({label:"tooltip.filter_library",icon:"mdi-bookshelf",action:et,active:l.value.libraryOnly}),a.showFavoritesOnlyFilter===!0&&t.push({label:"tooltip.filter_favorites",icon:l.value.favoritesOnly?"mdi-heart":"mdi-heart-outline",action:xe,active:l.value.favoritesOnly}),a.showAlbumArtistsOnlyFilter===!0&&t.push({label:"tooltip.album_artist_filter",icon:l.value.albumArtistsFilter?"mdi-account-music":"mdi-account-music-outline",action:tt,active:l.value.albumArtistsFilter}),(a.showRefreshButton!==!1||P.value)&&t.push({label:P.value?"tooltip.refresh_new_content":"tooltip.refresh",icon:"mdi-refresh",action:ot,active:P.value,disabled:C.value}),(i=a.sortKeys)!=null&&i.length&&t.push({label:"tooltip.sort_options",icon:"mdi-sort",subItems:a.sortKeys.map(V=>({label:`sort.${V}`,selected:l.value.sortBy==V,action:()=>{it(V)}}))}),a.showSearchButton!==!1&&t.push({label:he.value?"tooltip.search_filter_active":"tooltip.search",icon:"mdi-magnify",action:oe,active:he.value}),t.push({label:"tooltip.toggle_view_mode",icon:d.value=="list"?"mdi-view-list":"mdi-grid",subItems:[{label:"view.list",icon:"mdi-view-list",selected:d.value=="list",action:()=>{J("list")}},{label:"view.panel",icon:"mdi-grid",selected:d.value=="panel",action:()=>{J("panel")}}]}),(s=a.extraMenuItems)!=null&&s.length&&t.push(...a.extraMenuItems),a.allowCollapse===!0&&t.push({label:"tooltip.collapse_expand",icon:"mdi-chevron-up",action:X}),t}),N=async function(t=!1,i=a.limit,s=!1){if(!C.value){if(C.value=!0,(t||s)&&(l.value.offset=0,P.value=!1),l.value.limit=a.limit,l.value.refresh=s,a.loadPagedData!==void 0){const V=await a.loadPagedData(l.value);V&&(l.value.offset?e.value.push(...V.items):e.value=V.items,I.value=V.total)}else if(a.loadItems!==void 0){(c.value.length===0||s)&&(c.value=[],c.value=await a.loadItems(l.value),l.value,I.value=c.value.length);const V=ut(c.value,l.value);l.value.offset?e.value.push(...V):e.value=V}C.value=!1}},T=function(t,i=!1){return t?"label"in t&&t.label&&t.name?G(t.label,[t.name]):"label"in t&&t.label?G(t.label):i&&"sort_name"in t&&t.sort_name?t.sort_name:t.name:""},ut=function(t,i){var V,F;let s=[];if(i.search){const f=i.search.toLowerCase();for(const m of t)(m.name.toLowerCase().includes(f)||"artist"in m&&((V=m.artist)!=null&&V.name.toLowerCase().includes(f))||"album"in m&&((F=m.album)!=null&&F.name.toLowerCase().includes(f))||"artists"in m&&m.artists&&m.artists[0].name.toLowerCase().includes(f))&&s.push(m)}else s=t;return i.sortBy=="name"&&s.sort((f,m)=>T(f).localeCompare(T(m))),i.sortBy=="sort_name"&&s.sort((f,m)=>T(f,!0).localeCompare(T(m,!0))),i.sortBy=="name_desc"&&s.sort((f,m)=>T(m).localeCompare(T(f))),i.sortBy=="album"&&s.sort((f,m)=>T(f.album).localeCompare(T(m.album))),i.sortBy=="artist"&&s.sort((f,m)=>T(f.artists[0]).localeCompare(T(m.artists[0]))),i.sortBy=="track_number"&&(s.sort((f,m)=>(f.track_number||0)-(m.track_number||0)),s.sort((f,m)=>(f.disc_number||0)-(m.disc_number||0))),i.sortBy=="position"&&s.sort((f,m)=>(f.position||0)-(m.position||0)),i.sortBy=="position_desc"&&s.sort((f,m)=>(m.position||0)-(f.position||0)),i.sortBy=="year"&&s.sort((f,m)=>(f.year||0)-(m.year||0)),i.sortBy=="recent"&&s.sort((f,m)=>(m.timestamp_added||0)-(f.timestamp_added||0)),i.sortBy=="duration"&&s.sort((f,m)=>(f.duration||0)-(m.duration||0)),i.sortBy=="duration_desc"&&s.sort((f,m)=>(m.duration||0)-(f.duration||0)),i.sortBy=="provider"&&s.sort((f,m)=>f.provider.localeCompare(m.provider)),i.favoritesOnly&&(s=s.filter(f=>f.favorite)),s.slice(i.offset,i.offset+i.limit)},mt=async function(){const t=localStorage.getItem(`viewMode.${a.itemtype}`);t&&t!=="null"?d.value=t:a.itemtype=="artists"||a.itemtype=="albums"?d.value="panel":d.value="list";const i=localStorage.getItem(`sortBy.${a.itemtype}`);if(i&&i!=="null"&&a.sortKeys.includes(i)?l.value.sortBy=i:l.value.sortBy=a.sortKeys[0],a.showFavoritesOnlyFilter!==!1){const F=localStorage.getItem(`favoriteFilter.${a.itemtype}`);F&&F=="true"&&(l.value.favoritesOnly=!0)}if(a.showLibraryOnlyFilter!==!1){const F=localStorage.getItem(`libraryFilter.${a.itemtype}`);F&&F=="true"&&(l.value.libraryOnly=!0)}if(a.showAlbumArtistsOnlyFilter!==!1){const F=localStorage.getItem(`albumArtistsFilter.${a.itemtype}`);F&&(l.value.albumArtistsFilter=F=="true")}if(a.allowCollapse!==!1){const F=localStorage.getItem(`expand.${a.itemtype}`);F&&(A.value=F=="true")}let s=`search.${a.itemtype}`;a.parentItem&&(s+=a.parentItem.item_id);const V=localStorage.getItem(s);V&&V!=="null"&&(l.value.search=V)},be=function(t){if(!D.dialogActive)if(t.key==="a"&&(t.ctrlKey||t.metaKey)){for(t.preventDefault();e.value.length<I.value&&!(I.value!==void 0&&l.value.offset>=I.value);)l.value.offset+=a.limit,N();B.value=e.value,_.value=!0}else!w.value&&t.key=="Backspace"?l.value.search=l.value.search.slice(0,-1):!w.value&&t.key.length==1&&(l.value.search+=t.key,k.value=!0)};return a.allowKeyHooks&&(document.addEventListener("keydown",be),ge(()=>{document.removeEventListener("keydown",be)})),a.restoreState&&ge(()=>{const t=a.path||a.itemtype,i=document.querySelector("#cont");D.prevState={path:t,scrollPos:(i==null?void 0:i.scrollTop)||0,pagedItems:e.value,params:l.value,total:I.value||0}}),Y(()=>l.value.search,t=>{t&&(k.value=!0),N(!0);let i=`search.${a.itemtype}`;a.parentItem&&(i+=a.parentItem.item_id),localStorage.setItem(i,l.value.search)}),Y(()=>a.path,t=>{console.debug("Path updated to",t),C.value!=!0&&(c.value=[],N(!0))}),Y(()=>a.parentItem,()=>{C.value!=!0&&(c.value=[],P.value=!0)},{deep:!0}),Y(()=>a.limit,t=>{l.value.limit=t}),Y(()=>a.updateAvailable,t=>{C.value||(P.value=t)},{immediate:!0}),ht(async()=>{var i;mt();const t=a.path||a.itemtype;a.restoreState&&((i=D.prevState)==null?void 0:i.path)==t?(I.value=D.prevState.total,l.value=D.prevState.params,e.value=D.prevState.pagedItems,ke(()=>{const s=document.getElementById("cont");s&&It(s,D.prevState.scrollPos,50)}),C.value=!1):N(!0)}),(t,i)=>t.hideOnEmpty&&e.value.length==0?p("",!0):(n(),S("section",Da,[y(qt,{icon:t.icon,title:t.title,count:I.value,color:"transparent","menu-items":rt.value},null,8,["icon","title","count","menu-items"]),y(Xt),k.value&&A.value?(n(),b(At,{key:0,id:"searchInput",modelValue:l.value.search,"onUpdate:modelValue":i[0]||(i[0]=s=>l.value.search=s),clearable:"","prepend-inner-icon":"mdi-magnify",label:t.$t("search"),"hide-details":"",variant:"filled",style:{width:"auto","margin-top":"10px"},onFocus:i[1]||(i[1]=s=>w.value=!0),onBlur:i[2]||(i[2]=s=>w.value=!1),"onClick:clear":lt},null,8,["modelValue","label"])):p("",!0),y(bt,{name:"fade"},{default:u(()=>[A.value?(n(),b(Yt,{key:0,variant:d.value=="panel"?"panel":"default"},{default:u(()=>[C.value?(n(),b(jt,{key:0,indeterminate:""})):p("",!0),y(Jt,{items:e.value,onLoad:nt,mode:t.infiniteScroll?"intersect":"manual","load-more-text":t.$t("load_more_items"),"empty-text":"",style:{"overflow-y":"unset"}},{default:u(()=>[d.value=="panel"?(n(),b(ra,{key:0},{default:u(()=>[(n(!0),S(kt,null,wt(e.value,s=>(n(),b(ta,{key:s.uri,cols:"12",class:ne(`col-${g(Vt)(t.$vuetify.display.width)}`)},{default:u(()=>[y(Ma,{item:s,"is-selected":ve(s),"show-checkboxes":_.value,"show-track-number":t.showTrackNumber,"show-favorite":t.showFavoritesOnlyFilter,"show-actions":["tracks","albums"].includes(t.itemtype),onSelect:pe,onMenu:W,onClick:ye},null,8,["item","is-selected","show-checkboxes","show-track-number","show-favorite","show-actions"])]),_:2},1032,["class"]))),128))]),_:1})):p("",!0),d.value=="list"?(n(),b(Pt,{key:1,height:70,items:e.value,style:{height:"100%"}},{default:u(({item:s})=>[y(Aa,{item:s,"show-track-number":t.showTrackNumber,"show-disc-number":t.showTrackNumber,"show-duration":t.showDuration,"show-favorite":t.showFavoritesOnlyFilter,"show-menu":t.showMenu,"show-provider":t.showProvider,"show-album":t.showAlbum,"show-checkboxes":_.value,"is-selected":ve(s),"show-details":t.itemtype.includes("versions"),onSelect:pe,onMenu:W,onClick:ye},null,8,["item","show-track-number","show-disc-number","show-duration","show-favorite","show-menu","show-provider","show-album","show-checkboxes","is-selected","show-details"])]),_:1},8,["items"])):p("",!0)]),_:1},8,["items","mode","load-more-text"]),!C.value&&e.value.length==0?(n(),S("div",Ea,[!C.value&&e.value.length==0&&(l.value.search||l.value.favoritesOnly)?(n(),b(Ce,{key:0,title:t.$t("no_content_filter")},{default:u(()=>[l.value.search?(n(),b(Ie,{key:0,style:{"margin-top":"15px"},onClick:st},{default:u(()=>[$(h(t.$t("try_global_search")),1)]),_:1})):p("",!0)]),_:1},8,["title"])):!C.value&&e.value.length==0?(n(),b(Ce,{key:1},{default:u(()=>[$(h(t.$t("no_content")),1)]),_:1})):p("",!0)])):p("",!0),y(Qt,{"model-value":B.value.length>1,timeout:-1,style:{"margin-bottom":"120px"}},{actions:u(()=>[y(Ie,{color:"primary",variant:"text",onClick:i[3]||(i[3]=s=>W(s,B.value))},{default:u(()=>[$(h(t.$t("actions")),1)]),_:1})]),default:u(()=>[R("span",null,h(t.$t("items_selected",[B.value.length])),1)]),_:1},8,["model-value"])]),_:1},8,["variant"])):p("",!0)]),_:1})]))}});const lo=de(Ra,[["__scopeId","data-v-390d3f8b"]]);export{lo as I,ra as V,ta as a,ie as b};
