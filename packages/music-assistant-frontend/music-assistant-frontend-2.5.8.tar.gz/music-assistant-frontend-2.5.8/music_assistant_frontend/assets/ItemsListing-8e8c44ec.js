import{av as ee,aw as re,l as q,m as H,z as O,ax as Ae,D as Fe,A as Pe,ay as Oe,az as ft,f as h,E as z,v as vt,H as pt,r as B,d as te,c as n,e as y,u as g,ac as U,b as Le,a9 as Te,aA as G,g as _,w as m,i as j,t as b,X as $,j as p,a0 as ue,M as R,an as Ne,at as Me,af as Z,aB as yt,W as x,Y as ht,Q as bt,O as gt,_ as kt,h as De,a2 as wt,a as we,s as E,L as Y,o as St,T as Se,aC as _t,as as It,aD as Ct,F as Vt,am as Bt}from"./index-0c8861ae.js";import{M as Ee,f as Re,c as me,s as $t}from"./ItemContextMenu.vue_vue_type_style_index_0_scoped_369a0b53_lang-eaf2a063.js";import{_ as At}from"./eventbus-aecaceee.js";import{L as Ft}from"./ListItem-12afc0ff.js";import{B as je}from"./Button-9cbfc133.js";import{m as Pt,a as _e,V as Ot}from"./VTextField-21fe5b3d.js";import{m as Lt,u as Tt,a as Ie,V as Nt}from"./VVirtualScroll-986c6e83.js";import{m as de,b as ce,c as Ge,h as Mt,o as Dt,t as Et,v as Rt,w as K,C as jt,V as Gt,A as Kt,B as Q,x as Ut,s as Ce}from"./VListItem-fd2b5b2a.js";import{e as zt,g as Ht,b as se,f as Wt}from"./VMenu-986db18d.js";import{_ as ae}from"./_plugin-vue_export-helper-c27b6911.js";import{b as Yt,V as qt}from"./VCard-89641e47.js";import{V as Xt}from"./VSpacer-8121582e.js";import{V as Jt}from"./VAlert-d1094811.js";import{C as Qt}from"./Container-45dc8812.js";import{T as Zt}from"./Toolbar-7b246600.js";import{V as xt}from"./VList-b6d79911.js";import{a as ea,V as ta}from"./VInfiniteScroll-bb412d5e.js";/* empty css              */const Ke=(()=>ee.reduce((o,f)=>(o[f]={type:[Boolean,String,Number],default:!1},o),{}))(),Ue=(()=>ee.reduce((o,f)=>{const t="offset"+re(f);return o[t]={type:[String,Number],default:null},o},{}))(),ze=(()=>ee.reduce((o,f)=>{const t="order"+re(f);return o[t]={type:[String,Number],default:null},o},{}))(),Ve={col:Object.keys(Ke),offset:Object.keys(Ue),order:Object.keys(ze)};function aa(o,f,t){let r=o;if(!(t==null||t===!1)){if(f){const l=f.replace(o,"");r+=`-${l}`}return o==="col"&&(r="v-"+r),o==="col"&&(t===""||t===!0)||(r+=`-${t}`),r.toLowerCase()}}const la=["auto","start","end","center","baseline","stretch"],oa=q({cols:{type:[Boolean,String,Number],default:!1},...Ke,offset:{type:[String,Number],default:null},...Ue,order:{type:[String,Number],default:null},...ze,alignSelf:{type:String,default:null,validator:o=>la.includes(o)},...de(),...ce()},"VCol"),ia=H()({name:"VCol",props:oa(),setup(o,f){let{slots:t}=f;const r=O(()=>{const l=[];let c;for(c in Ve)Ve[c].forEach(w=>{const e=o[w],u=aa(c,w,e);u&&l.push(u)});const k=l.some(w=>w.startsWith("v-col-"));return l.push({"v-col":!k||!o.cols,[`v-col-${o.cols}`]:o.cols,[`offset-${o.offset}`]:o.offset,[`order-${o.order}`]:o.order,[`align-self-${o.alignSelf}`]:o.alignSelf}),l});return()=>{var l;return Ae(o.tag,{class:[r.value,o.class],style:o.style},(l=t.default)==null?void 0:l.call(t))}}}),fe=["start","end","center"],He=["space-between","space-around","space-evenly"];function ve(o,f){return ee.reduce((t,r)=>{const l=o+re(r);return t[l]=f(),t},{})}const sa=[...fe,"baseline","stretch"],We=o=>sa.includes(o),Ye=ve("align",()=>({type:String,default:null,validator:We})),na=[...fe,...He],qe=o=>na.includes(o),Xe=ve("justify",()=>({type:String,default:null,validator:qe})),ra=[...fe,...He,"stretch"],Je=o=>ra.includes(o),Qe=ve("alignContent",()=>({type:String,default:null,validator:Je})),Be={align:Object.keys(Ye),justify:Object.keys(Xe),alignContent:Object.keys(Qe)},ua={align:"align",justify:"justify",alignContent:"align-content"};function ma(o,f,t){let r=ua[o];if(t!=null){if(f){const l=f.replace(o,"");r+=`-${l}`}return r+=`-${t}`,r.toLowerCase()}}const da=q({dense:Boolean,noGutters:Boolean,align:{type:String,default:null,validator:We},...Ye,justify:{type:String,default:null,validator:qe},...Xe,alignContent:{type:String,default:null,validator:Je},...Qe,...de(),...ce()},"VRow"),ca=H()({name:"VRow",props:da(),setup(o,f){let{slots:t}=f;const r=O(()=>{const l=[];let c;for(c in Be)Be[c].forEach(k=>{const w=o[k],e=ma(c,k,w);e&&l.push(e)});return l.push({"v-row--no-gutters":o.noGutters,"v-row--dense":o.dense,[`align-${o.align}`]:o.align,[`justify-${o.justify}`]:o.justify,[`align-content-${o.alignContent}`]:o.alignContent}),l});return()=>{var l;return Ae(o.tag,{class:["v-row",r.value,o.class],style:o.style},(l=t.default)==null?void 0:l.call(t))}}});const fa=q({...Lt(),...Fe(Pt(),["inline"])},"VCheckbox"),Ze=H()({name:"VCheckbox",inheritAttrs:!1,props:fa(),emits:{"update:modelValue":o=>!0,"update:focused":o=>!0},setup(o,f){let{attrs:t,slots:r}=f;const l=Pe(o,"modelValue"),{isFocused:c,focus:k,blur:w}=Tt(o),e=Oe(),u=O(()=>o.id||`checkbox-${e}`);return Ge(()=>{const[S,I]=ft(t),C=Ie.filterProps(o),L=_e.filterProps(o);return h(Ie,z({class:["v-checkbox",o.class]},S,C,{modelValue:l.value,"onUpdate:modelValue":V=>l.value=V,id:u.value,focused:c.value,style:o.style}),{...r,default:V=>{let{id:A,messagesId:F,isDisabled:X,isReadonly:le,isValid:oe}=V;return h(_e,z(L,{id:A.value,"aria-describedby":F.value,disabled:X.value,readonly:le.value},I,{error:oe.value===!1,modelValue:l.value,"onUpdate:modelValue":J=>l.value=J,onFocus:k,onBlur:w}),r)}})}),{}}});const xe=Symbol.for("vuetify:v-item-group"),va=q({...de(),...Mt({selectedClass:"v-item--selected"}),...ce(),...vt()},"VItemGroup"),et=H()({name:"VItemGroup",props:va(),emits:{"update:modelValue":o=>!0},setup(o,f){let{slots:t}=f;const{themeClasses:r}=pt(o),{isSelected:l,select:c,next:k,prev:w,selected:e}=Dt(o,xe);return()=>h(o.tag,{class:["v-item-group",r.value,o.class],style:o.style},{default:()=>{var u;return[(u=t.default)==null?void 0:u.call(t,{isSelected:l,select:c,next:k,prev:w,selected:e.value})]}})}}),D=H()({name:"VItem",props:Et(),emits:{"group:selected":o=>!0},setup(o,f){let{slots:t}=f;const{isSelected:r,select:l,toggle:c,selectedClass:k,value:w,disabled:e}=Rt(o,xe);return()=>{var u;return(u=t.default)==null?void 0:u.call(t,{isSelected:r.value,selectedClass:k.value,select:l,toggle:c,value:w.value,disabled:e.value})}}});const pa=q({id:String,text:String,...Fe(zt({closeOnBack:!1,location:"end",locationStrategy:"connected",eager:!0,minWidth:0,offset:10,openOnClick:!1,openOnHover:!0,origin:"auto",scrim:!1,scrollStrategy:"reposition",transition:!1}),["absolute","persistent"])},"VTooltip"),ne=H()({name:"VTooltip",props:pa(),emits:{"update:modelValue":o=>!0},setup(o,f){let{slots:t}=f;const r=Pe(o,"modelValue"),{scopeId:l}=Ht(),c=Oe(),k=O(()=>o.id||`v-tooltip-${c}`),w=B(),e=O(()=>o.location.split(" ").length>1?o.location:o.location+" center"),u=O(()=>o.origin==="auto"||o.origin==="overlap"||o.origin.split(" ").length>1||o.location.split(" ").length>1?o.origin:o.origin+" center"),S=O(()=>o.transition?o.transition:r.value?"scale-transition":"fade-transition"),I=O(()=>z({"aria-describedby":k.value},o.activatorProps));return Ge(()=>{const C=se.filterProps(o);return h(se,z({ref:w,class:["v-tooltip",o.class],style:o.style,id:k.value},C,{modelValue:r.value,"onUpdate:modelValue":L=>r.value=L,transition:S.value,absolute:!0,location:e.value,origin:u.value,persistent:!0,role:"tooltip",activatorProps:I.value,_disableGlobalStack:!0},l),{activator:t.activator,default:function(){var F;for(var L=arguments.length,V=new Array(L),A=0;A<L;A++)V[A]=arguments[A];return((F=t.default)==null?void 0:F.call(t,...V))??o.text}})}),Wt({},w)}}),tt=te({__name:"FavoriteButton",props:{item:{}},setup(o){const f=o;return(t,r)=>{var l;return n(),y(je,z(f,{variant:"list",icon:(l=t.item)!=null&&l.favorite?"mdi-heart":"mdi-heart-outline",title:t.$t("tooltip.favorite"),onClick:[r[0]||(r[0]=c=>g(Le).toggleFavorite(t.item)),r[1]||(r[1]=U(()=>{},["prevent"])),r[2]||(r[2]=U(()=>{},["stop"]))]}),null,16,["icon","title"])}}}),ya={key:0,class:"media-thumb listitem-media-thumb"},ha={key:1,class:"media-thumb listitem-media-thumb"},ba={key:0},ga={key:1},ka={key:0},wa={key:0,class:"line-clamp-1"},Sa={key:1},_a={key:0},Ia={key:1},Ca={key:2},Va={key:3},Ba={key:4},$a={key:5},Aa={key:2},Fa={key:3},Pa={class:"text-caption",style:{"padding-right":"10px","padding-left":"10px"}},Oa=te({__name:"ListviewItem",props:{item:{},showTrackNumber:{type:Boolean,default:!0},showDiscNumber:{type:Boolean,default:!0},showPosition:{type:Boolean,default:!0},showProvider:{type:Boolean,default:!0},showAlbum:{type:Boolean,default:!0},showMenu:{type:Boolean,default:!0},showFavorite:{type:Boolean,default:!1},showDuration:{type:Boolean,default:!0},isSelected:{type:Boolean},isDisabled:{type:Boolean,default:!1},showCheckboxes:{type:Boolean,default:!1},showDetails:{type:Boolean}},emits:["menu","click","select"],setup(o,{emit:f}){const{t}=Te(),r=o,l=O(()=>{if(!("provider_mappings"in r.item))return"";for(const e of r.item.provider_mappings)if(e.audio_format&&e.audio_format.content_type!=null&&[G.DSF,G.FLAC,G.AIFF,G.WAV].includes(e.audio_format.content_type)&&(e.audio_format.sample_rate>48e3||e.audio_format.bit_depth>16))return`${e.audio_format.sample_rate/1e3}kHz ${e.audio_format.bit_depth} bits`;return""}),c=f,k=function(e){r.showCheckboxes||c("menu",e,r.item)},w=function(e){r.showCheckboxes||c("click",e,r.item)};return(e,u)=>(n(),_("div",null,[h(Ft,{link:"",disabled:!g(me)(e.item)||e.isDisabled,"show-menu-btn":e.showMenu,onClick:U(w,["stop"]),onMenu:U(k,["stop"])},{prepend:m(()=>[e.showCheckboxes?(n(),_("div",ya,[h(Ze,{"model-value":e.isSelected,onClick:u[0]||(u[0]=U(()=>{},["stop"])),"onUpdate:modelValue":u[1]||(u[1]=S=>{S!=null&&c("select",e.item,S)})},null,8,["model-value"])])):(n(),_("div",ha,[h(Ee,{size:"50",item:e.item},null,8,["item"])]))]),title:m(()=>[e.item.media_type==g(R).FOLDER?(n(),_("span",ba,[j("span",null,b(g(Ne)(e.item,g(t))),1)])):(n(),_("span",ga,[$(b(e.item.name)+" ",1),"version"in e.item&&e.item.version?(n(),_("span",ka,"("+b(e.item.version)+")",1)):p("",!0)])),e.item&&e.item.metadata?(n(),y(g(ne),{key:2,location:"bottom"},{activator:m(({props:S})=>[g(Me)(e.item.metadata.explicit||!1)?(n(),y(K,z({key:0},S,{icon:"mdi-alpha-e-box",width:"35"}),null,16)):p("",!0)]),default:m(()=>[j("span",null,b(e.$t("tooltip.explicit")),1)]),_:1})):p("",!0)]),subtitle:m(()=>[e.item.media_type==g(R).TRACK&&"provider_mappings"in e.item?(n(),_("div",wa,[h(et,null,{default:m(()=>["artists"in e.item?(n(),y(D,{key:0},{default:m(()=>[$(b(g(Z)(e.item.artists,2)),1)]),_:1})):p("",!0),e.showAlbum&&"album"in e.item&&e.item.album?(n(),y(D,{key:1},{default:m(()=>[$(" • "+b(e.item.album.name),1)]),_:1})):p("",!0),e.showDiscNumber&&"disc_number"in e.item&&e.item.disc_number!=null?(n(),y(D,{key:2},{default:m(()=>[h(K,{style:{"margin-left":"5px"},icon:"md:album"}),$(" "+b(e.item.disc_number),1)]),_:1})):p("",!0),e.showTrackNumber&&"track_number"in e.item&&e.item.track_number!=null?(n(),y(D,{key:3},{default:m(()=>[h(K,{style:{"margin-left":"5px"},icon:"mdi-music-circle-outline"}),$(" "+b(e.item.track_number),1)]),_:1})):e.showPosition&&"position"in e.item&&e.item.position!=null?(n(),y(D,{key:4},{default:m(()=>[h(K,{style:{"margin-left":"5px"},icon:"mdi-music-circle-outline"}),$(" "+b(e.item.position),1)]),_:1})):p("",!0)]),_:1})])):e.item.media_type==g(R).ALBUM&&"year"in e.item?(n(),_("div",Sa,[e.item.album_type!=g(yt).UNKNOWN?(n(),_("span",_a,b(e.$t("album_type."+e.item.album_type))+" • ",1)):p("",!0),j("span",null,b(g(Z)(e.item.artists)),1),e.item.year?(n(),_("span",Ia," • "+b(e.item.year),1)):p("",!0)])):"artists"in e.item&&e.item.artists?(n(),_("div",Ca,b(g(Z)(e.item.artists)),1)):"owner"in e.item&&e.item.owner?(n(),_("div",Va,b(e.item.owner),1)):e.item.media_type==g(R).RADIO&&e.item.metadata.description?(n(),_("div",Ba,b(e.item.metadata.description),1)):"media_type"in e.item&&!e.item.provider_mappings?(n(),_("div",$a,b(e.$t(e.item.media_type)),1)):p("",!0)]),append:m(()=>[l.value?(n(),y(jt,{key:0,src:g(Re),width:"30",class:ue(e.$vuetify.theme.current.dark?"hiresicondark":"hiresicon")},{default:m(()=>[h(g(ne),{activator:"parent",location:"bottom"},{default:m(()=>[$(b(l.value),1)]),_:1})]),_:1},8,["src","class"])):p("",!0),g(x)("bp2")&&e.showProvider?(n(),y(At,{key:1,domain:e.item.media_type==g(R).PLAYLIST?e.item.provider_mappings[0].provider_domain:e.item.provider,size:24},null,8,["domain"])):p("",!0),g(x)("bp3")&&"favorite"in e.item&&e.showFavorite&&!e.$vuetify.display.mobile?(n(),_("div",Aa,[h(tt,{item:e.item},null,8,["item"])])):p("",!0),e.showDuration&&e.item.media_type==g(R).TRACK&&"duration"in e.item&&e.item.duration!=null&&g(x)("bp0")?(n(),_("div",Fa,[j("div",null,[j("span",Pa,b(g(ht)(e.item.duration)),1)])])):p("",!0)]),_:1},8,["disabled","show-menu-btn"])]))}});const La=ae(Oa,[["__scopeId","data-v-ea7b9ed3"]]),Ta={key:0},Na={key:1},Ma={key:2},Da=["src"],Ea={key:0},Ra=te({__name:"PanelviewItem",props:{item:{},size:{default:200},isSelected:{type:Boolean},showCheckboxes:{type:Boolean,default:!1},showMediaType:{type:Boolean,default:!1},showActions:{type:Boolean,default:!1}},emits:["menu","click","select"],setup(o,{emit:f}){const t=o,r=B(!1),l=O(()=>{for(const e of t.item.provider_mappings)if(e.audio_format&&e.audio_format.content_type!=null&&[G.DSF,G.FLAC,G.AIFF,G.WAV].includes(e.audio_format.content_type)&&(e.audio_format.sample_rate>48e3||e.audio_format.bit_depth>16))return`${e.audio_format.sample_rate/1e3}kHz ${e.audio_format.bit_depth} bits`;return""}),c=f,k=function(e){t.showCheckboxes||c("menu",e,t.item)},w=function(e){t.showCheckboxes||c("click",e,t.item)};return(e,u)=>{const S=bt("hold");return gt((n(),y(qt,{tile:"",hover:"",class:"panel-item",disabled:!g(me)(e.item),onClick:w,onContextmenu:U(k,["right","prevent"]),onMouseover:u[2]||(u[2]=I=>r.value=!0),onMouseleave:u[3]||(u[3]=I=>r.value=!1)},{default:m(()=>[e.showCheckboxes?(n(),y(se,{key:0,"model-value":e.showCheckboxes,contained:"",scrim:e.isSelected?e.$vuetify.theme.current.dark?"rgba(0,0,0,.75)":"rgba(255,255,255,.75)":"#ffffff00",onClick:u[0]||(u[0]=I=>{c("select",e.item,!e.isSelected)})},{default:m(()=>[h(Ze,{class:"panel-item-checkbox",ripple:!1,"model-value":e.isSelected},null,8,["model-value"])]),_:1},8,["model-value","scrim"])):p("",!0),h(Ee,{item:e.item,style:{height:"auto"}},null,8,["item"]),h(Gt,{variant:"text",slim:"",tile:"",density:"compact",class:"panel-item-details"},{default:m(()=>[h(Kt,null,{default:m(()=>[e.item.media_type==g(R).FOLDER?(n(),_("span",Ta,[j("span",null,b(g(Ne)(e.item,e.$t)),1)])):(n(),_("span",Na,b(e.item.name),1)),"version"in e.item&&e.item.version?(n(),_("span",Ma," - "+b(e.item.version),1)):p("",!0)]),_:1}),"artists"in e.item&&e.item.artists?(n(),y(Q,{key:0,class:"line-clamp-1"},{default:m(()=>[$(b(g(Z)(e.item.artists,1)),1)]),_:1})):"owner"in e.item&&e.item.owner?(n(),y(Q,{key:1,class:"line-clamp-1"},{default:m(()=>[$(b(e.item.owner),1)]),_:1})):e.showMediaType?(n(),y(Q,{key:2,class:"line-clamp-1"},{default:m(()=>[$(b(e.$t(e.item.media_type)),1)]),_:1})):(n(),y(Q,{key:3,class:"line-clamp-1"}))]),_:1}),e.showActions?(n(),y(Yt,{key:1,class:"panel-item-actions"},{default:m(()=>[h(et,{style:{padding:"0"}},{default:m(()=>[g(Me)(e.item.metadata.explicit||!1)?(n(),y(D,{key:0},{default:m(()=>[h(K,{size:"30",icon:"mdi-alpha-e-box"})]),_:1})):p("",!0),l.value?(n(),y(D,{key:1},{default:m(()=>[h(K,{class:ue(e.$vuetify.theme.current.dark?"hiresicon":"hiresiconinverted")},{default:m(()=>[j("img",{src:g(Re),width:"30"},null,8,Da),h(ne,{activator:"parent",location:"bottom"},{default:m(()=>[$(b(l.value),1)]),_:1})]),_:1},8,["class"])]),_:1})):p("",!0),"track_number"in e.item&&e.item.track_number||"position"in e.item&&e.item.position?(n(),y(D,{key:2},{default:m(()=>[h(K,{size:"small",icon:"mdi-music-circle-outline"}),e.item.disc_number?(n(),_("span",Ea,b(e.item.disc_number)+"/",1)):p("",!0),$(b(e.item.track_number||e.item.position),1)]),_:1})):p("",!0),g(x)("bp3")?(n(),y(D,{key:3},{default:m(()=>[h(tt,{item:e.item},null,8,["item"])]),_:1})):p("",!0)]),_:1}),h(Xt),r.value?(n(),y(je,{key:0,variant:"list",icon:"mdi-dots-vertical",style:{"padding-right":"0","margin-right":"-5px"},onClick:u[1]||(u[1]=U(I=>e.$emit("menu",I,e.item),["stop"]))})):p("",!0)]),_:1})):p("",!0)]),_:1},8,["disabled"])),[[S,k]])}}});const ja=ae(Ra,[["__scopeId","data-v-2ff5074d"]]),Ga={setup(o,f){const t=O(()=>({}));return{alertProps:O(()=>({...t.value,...f.attrs}))}}};function Ka(o,f,t,r,l,c){return n(),y(Jt,z(r.alertProps,{class:"alert",color:"primary",density:"compact",prominent:""}),kt({_:2},[De(o.$slots,(k,w)=>({name:w,fn:m(()=>[wt(o.$slots,w)])}))]),1040)}const $e=ae(Ga,[["render",Ka]]),Ua={key:0},za={key:1},Ha=te({__name:"ItemsListing",props:{itemtype:{},sortKeys:{default:()=>["name","sort_name"]},showTrackNumber:{type:Boolean,default:!0},showProvider:{type:Boolean,default:Object.keys(Le.providers).length>1},showAlbum:{type:Boolean,default:!0},showMenu:{type:Boolean,default:!0},showFavoritesOnlyFilter:{type:Boolean,default:!0},showDuration:{type:Boolean,default:!0},parentItem:{default:void 0},showAlbumArtistsOnlyFilter:{type:Boolean},showSearchButton:{type:Boolean,default:void 0},showRefreshButton:{type:Boolean,default:void 0},showSelectButton:{type:Boolean,default:void 0},updateAvailable:{type:Boolean},title:{default:void 0},hideOnEmpty:{type:Boolean,default:!1},showLibraryOnlyFilter:{type:Boolean,default:!1},allowCollapse:{type:Boolean,default:!1},allowKeyHooks:{type:Boolean,default:!1},extraMenuItems:{default:void 0},loadPagedData:{type:Function,default:void 0},loadItems:{type:Function,default:void 0},limit:{default:50},infiniteScroll:{type:Boolean,default:!0},path:{default:void 0},icon:{default:void 0},restoreState:{type:Boolean,default:!1},noServerSideSorting:{type:Boolean,default:!1}},emits:["refreshClicked"],setup(o,{emit:f}){const t=o,r=It(),l=B({offset:0,limit:50,sortBy:"name",search:"",libraryOnly:!1}),c=B("list"),k=B(!1),w=B(!1),e=B([]),u=B([]),S=B(),I=B(!1),C=B([]),L=B(!1),V=B(!1),A=B(!0),F=B(!1),{t:X}=Te(),le=f,oe=function(){k.value?k.value=!1:(k.value=!0,Se(()=>{var a;(a=document.getElementById("searchInput"))==null||a.focus()}))},J=function(){A.value=!A.value,localStorage.setItem(`expand.${t.itemtype}`,A.value.toString())},pe=function(a){c.value=a,localStorage.setItem(`viewMode.${t.itemtype}`,a)},at=function(){l.value.favoritesOnly=!l.value.favoritesOnly;const a=l.value.favoritesOnly?"true":"false";localStorage.setItem(`favoriteFilter.${t.itemtype}`,a),T(!0)},lt=function(){l.value.libraryOnly=!l.value.libraryOnly;const a=l.value.libraryOnly?"true":"false";localStorage.setItem(`libraryFilter.${t.itemtype}`,a),T(!0,!0)},ot=function(){l.value.albumArtistsFilter=!l.value.albumArtistsFilter;const a=l.value.albumArtistsFilter?"true":"false";localStorage.setItem(`albumArtistsFilter.${t.itemtype}`,a),T(!0)},ye=function(a){return C.value.includes(a)},he=function(a,i){if(i)C.value.includes(a)||C.value.push(a);else for(let s=0;s<C.value.length;s++)C.value[s]===a&&C.value.splice(s,1)},it=function(){V.value&&(C.value=[]),V.value=!V.value},W=function(a,i){const s=Array.isArray(i)?i:[i];$t(s,t.parentItem,a.clientX,a.clientY)},st=function(){le("refreshClicked"),T(!0,!0)},be=function(a,i){if(!me(i)){W(a,i);return}i.media_type==R.FOLDER?r.push({name:"browse",query:{path:i.path}}):["artist","album","playlist"].includes(i.media_type)?r.push({name:i.media_type,params:{itemId:i.item_id,provider:i.provider}}):W(a,i)},nt=function(){l.value.search="",k.value=!1,T(!0)},rt=function(a,i){a!==void 0&&(l.value.sortBy=a),localStorage.setItem(`sortBy.${t.itemtype}`,l.value.sortBy),T(!0,a=="original")},ut=function(){E.globalSearchTerm=l.value.search,r.push({name:"search"})},mt=function({done:a}){if(e.value.length==0){a("empty");return}if(F.value){a("empty");return}a("loading"),l.value.offset+=t.limit,T().then(()=>{a("ok")})},ge=O(()=>{var a=!1;return l.value.search&&l.value.search.length!==0&&(a=!0),a}),dt=O(()=>{var i,s;if(t.allowCollapse===!0&&!A.value)return[{label:"tooltip.collapse_expand",icon:"mdi-chevron-down",action:J,overflowAllowed:!1}];const a=[];return t.showSelectButton!==!1&&a.push({label:"tooltip.select_items",icon:V.value?"mdi-checkbox-multiple-outline":"mdi-checkbox-multiple-blank-outline",action:it,active:V.value}),t.showLibraryOnlyFilter===!0&&a.push({label:"tooltip.filter_library",icon:"mdi-bookshelf",action:lt,active:l.value.libraryOnly}),t.showFavoritesOnlyFilter===!0&&a.push({label:"tooltip.filter_favorites",icon:l.value.favoritesOnly?"mdi-heart":"mdi-heart-outline",action:at,active:l.value.favoritesOnly}),t.showAlbumArtistsOnlyFilter===!0&&a.push({label:"tooltip.album_artist_filter",icon:l.value.albumArtistsFilter?"mdi-account-music":"mdi-account-music-outline",action:ot,active:l.value.albumArtistsFilter}),(t.showRefreshButton!==!1||L.value)&&a.push({label:L.value?"tooltip.refresh_new_content":"tooltip.refresh",icon:"mdi-refresh",action:st,active:L.value,disabled:I.value}),(i=t.sortKeys)!=null&&i.length&&a.push({label:"tooltip.sort_options",icon:"mdi-sort",subItems:t.sortKeys.map(M=>({label:`sort.${M}`,selected:l.value.sortBy==M,action:()=>{rt(M)}}))}),t.showSearchButton!==!1&&a.push({label:ge.value?"tooltip.search_filter_active":"tooltip.search",icon:"mdi-magnify",action:oe,active:ge.value}),a.push({label:"tooltip.toggle_view_mode",icon:c.value=="list"?"mdi-view-list":"mdi-grid",subItems:[{label:"view.list",icon:"mdi-view-list",selected:c.value=="list",action:()=>{pe("list")}},{label:"view.panel",icon:"mdi-grid",selected:c.value=="panel",action:()=>{pe("panel")}}]}),(s=t.extraMenuItems)!=null&&s.length&&a.push(...t.extraMenuItems),t.allowCollapse===!0&&a.push({label:"tooltip.collapse_expand",icon:"mdi-chevron-up",action:J}),a}),T=async function(a=!1,i=!1){if(!I.value){if(I.value=!0,(a||i)&&(l.value.offset=0,L.value=!1),l.value.limit=t.limit,l.value.refresh=i,t.loadPagedData!==void 0)if(t.noServerSideSorting&&F.value)l.value.offset=0,l.value.limit=u.value.length,e.value=ie(u.value,l.value);else if(t.noServerSideSorting&&l.value.search){for(u.value.push(...e.value);!F.value;){const s=await t.loadPagedData(l.value);if(u.value.push(...s.items),s.total!=null)S.value=s.total;else if(u.value.length!=l.value.limit){S.value=u.value.length;break}if(S.value!=null&&u.value.length>=S.value)break;l.value.offset+=50}F.value=!0,l.value.offset=0,l.value.limit=S.value||l.value.limit,e.value=ie(u.value,l.value)}else{const s=await t.loadPagedData(l.value);l.value.offset?e.value.push(...s.items):e.value=s.items,s.total!=null?S.value=s.total:s.items.length!=l.value.limit&&(s.total=e.value.length),F.value=S.value!=null&&e.value.length>=S.value,F.value&&t.noServerSideSorting&&(u.value=e.value)}else if(t.loadItems!==void 0){(!F.value||i)&&(u.value=[],u.value=await t.loadItems(l.value),l.value,S.value=u.value.length,F.value=!0);const s=ie(u.value,l.value);l.value.offset?e.value.push(...s):e.value=s}I.value=!1}},N=function(a,i=!1){return a?"label"in a&&a.label&&a.name?X(a.label,[a.name]):"label"in a&&a.label?X(a.label):i&&"sort_name"in a&&a.sort_name?a.sort_name:a.name:""},ie=function(a,i){var M,P;let s=[];if(i.search){const v=i.search.toLowerCase();for(const d of a)(d.name.toLowerCase().includes(v)||"artist"in d&&((M=d.artist)!=null&&M.name.toLowerCase().includes(v))||"album"in d&&((P=d.album)!=null&&P.name.toLowerCase().includes(v))||"artists"in d&&d.artists&&d.artists[0].name.toLowerCase().includes(v))&&s.push(d)}else s=a;return i.sortBy=="name"&&s.sort((v,d)=>N(v).localeCompare(N(d))),i.sortBy=="sort_name"&&s.sort((v,d)=>N(v,!0).localeCompare(N(d,!0))),i.sortBy=="name_desc"&&s.sort((v,d)=>N(d).localeCompare(N(v))),i.sortBy=="album"&&s.sort((v,d)=>N(v.album).localeCompare(N(d.album))),i.sortBy=="artist"&&s.sort((v,d)=>N(v.artists[0]).localeCompare(N(d.artists[0]))),i.sortBy=="track_number"&&(s.sort((v,d)=>(v.track_number||0)-(d.track_number||0)),s.sort((v,d)=>(v.disc_number||0)-(d.disc_number||0))),i.sortBy=="position"&&s.sort((v,d)=>(v.position||0)-(d.position||0)),i.sortBy=="position_desc"&&s.sort((v,d)=>(d.position||0)-(v.position||0)),i.sortBy=="year"&&s.sort((v,d)=>(v.year||0)-(d.year||0)),i.sortBy=="recent"&&s.sort((v,d)=>(d.timestamp_added||0)-(v.timestamp_added||0)),i.sortBy=="duration"&&s.sort((v,d)=>(v.duration||0)-(d.duration||0)),i.sortBy=="duration_desc"&&s.sort((v,d)=>(d.duration||0)-(v.duration||0)),i.sortBy=="provider"&&s.sort((v,d)=>v.provider.localeCompare(d.provider)),i.favoritesOnly&&(s=s.filter(v=>v.favorite)),s.slice(i.offset,i.offset+i.limit)},ct=async function(){const a=localStorage.getItem(`viewMode.${t.itemtype}`);a&&a!=="null"?c.value=a:t.itemtype=="artists"||t.itemtype=="albums"?c.value="panel":c.value="list";const i=localStorage.getItem(`sortBy.${t.itemtype}`);if(i&&i!=="null"&&t.sortKeys.includes(i)?l.value.sortBy=i:l.value.sortBy=t.sortKeys[0],t.showFavoritesOnlyFilter!==!1){const P=localStorage.getItem(`favoriteFilter.${t.itemtype}`);P&&P=="true"&&(l.value.favoritesOnly=!0)}if(t.showLibraryOnlyFilter!==!1){const P=localStorage.getItem(`libraryFilter.${t.itemtype}`);P&&P=="true"&&(l.value.libraryOnly=!0)}if(t.showAlbumArtistsOnlyFilter!==!1){const P=localStorage.getItem(`albumArtistsFilter.${t.itemtype}`);P&&(l.value.albumArtistsFilter=P=="true")}if(t.allowCollapse!==!1){const P=localStorage.getItem(`expand.${t.itemtype}`);P&&(A.value=P=="true")}let s=`search.${t.itemtype}`;t.parentItem&&(s+=t.parentItem.item_id);const M=localStorage.getItem(s);M&&M!=="null"&&(l.value.search=M)},ke=function(a){if(!E.dialogActive)if(a.key==="a"&&(a.ctrlKey||a.metaKey)){for(a.preventDefault();e.value.length<S.value&&!(S.value!==void 0&&l.value.offset>=S.value);)l.value.offset+=t.limit,T();C.value=e.value,V.value=!0}else!w.value&&a.key=="Backspace"?l.value.search=l.value.search.slice(0,-1):!w.value&&a.key.length==1&&(l.value.search+=a.key,k.value=!0)};return t.allowKeyHooks&&(document.addEventListener("keydown",ke),we(()=>{document.removeEventListener("keydown",ke)})),t.restoreState&&we(()=>{const a=t.path||t.itemtype,i=document.querySelector("#cont");E.prevState={path:a,scrollPos:(i==null?void 0:i.scrollTop)||0,pagedItems:e.value,params:l.value,total:S.value||0}}),Y(()=>l.value.search,a=>{a&&(k.value=!0),T(!0);let i=`search.${t.itemtype}`;t.parentItem&&(i+=t.parentItem.item_id),localStorage.setItem(i,l.value.search)}),Y(()=>t.path,a=>{console.debug("Path updated to",a),I.value!=!0&&(e.value=[],u.value=[],F.value=!1,T(!0))}),Y(()=>t.parentItem,()=>{I.value!=!0&&(u.value=[],L.value=!0)},{deep:!0}),Y(()=>t.limit,a=>{l.value.limit=a}),Y(()=>t.updateAvailable,a=>{I.value||(L.value=a)},{immediate:!0}),St(async()=>{var i;ct();const a=t.path||t.itemtype;t.restoreState&&((i=E.prevState)==null?void 0:i.path)==a?(S.value=E.prevState.total,l.value=E.prevState.params,e.value=E.prevState.pagedItems,Se(()=>{const s=document.getElementById("cont");s&&Ct(s,E.prevState.scrollPos,50)}),I.value=!1):T(!0)}),(a,i)=>a.hideOnEmpty&&e.value.length==0?p("",!0):(n(),_("section",Ua,[h(Zt,{icon:a.icon,title:a.title,count:S.value,color:"transparent","menu-items":dt.value},null,8,["icon","title","count","menu-items"]),h(xt),k.value&&A.value?(n(),y(Ot,{key:0,id:"searchInput",modelValue:l.value.search,"onUpdate:modelValue":i[0]||(i[0]=s=>l.value.search=s),clearable:"","prepend-inner-icon":"mdi-magnify",label:a.$t("search"),"hide-details":"",variant:"filled",style:{width:"auto","margin-top":"10px"},onFocus:i[1]||(i[1]=s=>w.value=!0),onBlur:i[2]||(i[2]=s=>w.value=!1),"onClick:clear":nt},null,8,["modelValue","label"])):p("",!0),h(_t,{name:"fade"},{default:m(()=>[A.value?(n(),y(Qt,{key:0,variant:c.value=="panel"?"panel":"default"},{default:m(()=>[I.value?(n(),y(Ut,{key:0,indeterminate:""})):p("",!0),h(ea,{items:e.value,onLoad:mt,mode:a.infiniteScroll?"intersect":"manual","load-more-text":a.$t("load_more_items"),"empty-text":"",style:{"overflow-y":"unset"}},{default:m(()=>[c.value=="panel"?(n(),y(ca,{key:0},{default:m(()=>[(n(!0),_(Vt,null,De(e.value,s=>(n(),y(ia,{key:s.uri,cols:"12",class:ue(`col-${g(Bt)(a.$vuetify.display.width)}`)},{default:m(()=>[h(ja,{item:s,"is-selected":ye(s),"show-checkboxes":V.value,"show-track-number":a.showTrackNumber,"show-favorite":a.showFavoritesOnlyFilter,"show-actions":["tracks","albums"].includes(a.itemtype),onSelect:he,onMenu:W,onClick:be},null,8,["item","is-selected","show-checkboxes","show-track-number","show-favorite","show-actions"])]),_:2},1032,["class"]))),128))]),_:1})):p("",!0),c.value=="list"?(n(),y(Nt,{key:1,height:70,items:e.value,style:{height:"100%"}},{default:m(({item:s})=>[h(La,{item:s,"show-track-number":a.showTrackNumber,"show-disc-number":a.showTrackNumber,"show-duration":a.showDuration,"show-favorite":a.showFavoritesOnlyFilter,"show-menu":a.showMenu,"show-provider":a.showProvider,"show-album":a.showAlbum,"show-checkboxes":V.value,"is-selected":ye(s),"show-details":a.itemtype.includes("versions"),onSelect:he,onMenu:W,onClick:be},null,8,["item","show-track-number","show-disc-number","show-duration","show-favorite","show-menu","show-provider","show-album","show-checkboxes","is-selected","show-details"])]),_:1},8,["items"])):p("",!0)]),_:1},8,["items","mode","load-more-text"]),!I.value&&e.value.length==0?(n(),_("div",za,[!I.value&&e.value.length==0&&(l.value.search||l.value.favoritesOnly)?(n(),y($e,{key:0,title:a.$t("no_content_filter")},{default:m(()=>[l.value.search?(n(),y(Ce,{key:0,style:{"margin-top":"15px"},onClick:ut},{default:m(()=>[$(b(a.$t("try_global_search")),1)]),_:1})):p("",!0)]),_:1},8,["title"])):!I.value&&e.value.length==0?(n(),y($e,{key:1},{default:m(()=>[$(b(a.$t("no_content")),1)]),_:1})):p("",!0)])):p("",!0),h(ta,{"model-value":C.value.length>1,timeout:-1,style:{"margin-bottom":"120px"}},{actions:m(()=>[h(Ce,{color:"primary",variant:"text",onClick:i[3]||(i[3]=s=>W(s,C.value))},{default:m(()=>[$(b(a.$t("actions")),1)]),_:1})]),default:m(()=>[j("span",null,b(a.$t("items_selected",[C.value.length])),1)]),_:1},8,["model-value"])]),_:1},8,["variant"])):p("",!0)]),_:1})]))}});const ml=ae(Ha,[["__scopeId","data-v-09a57c32"]]);export{ml as I,ca as V,ia as a,ne as b};
