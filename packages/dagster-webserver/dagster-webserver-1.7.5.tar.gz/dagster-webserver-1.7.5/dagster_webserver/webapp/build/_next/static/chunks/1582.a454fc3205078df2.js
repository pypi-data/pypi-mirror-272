(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1582],{30733:function(e,t,n){var r=n(96738);function memoize(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw TypeError("Expected a function");var memoized=function(){var n=arguments,r=t?t.apply(this,n):n[0],o=memoized.cache;if(o.has(r))return o.get(r);var i=e.apply(this,n);return memoized.cache=o.set(r,i)||o,i};return memoized.cache=new(memoize.Cache||r),memoized}memoize.Cache=r,e.exports=memoize},31582:function(e,t,n){"use strict";function _object_spread_object_spread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r})}return e}function _object_spread_props_object_spread_props(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}function _array_like_to_array(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function _unsupported_iterable_to_array(e,t){if(e){if("string"==typeof e)return _array_like_to_array(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _array_like_to_array(e,t)}}function _sliced_to_array_sliced_to_array(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var i=[],a=!0,u=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){u=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(u)throw r}}return i}}(e,t)||_unsupported_iterable_to_array(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var r,o,i,a,u,d=n(46506);function _to_consumable_array_to_consumable_array(e){return function(e){if(Array.isArray(e))return _array_like_to_array(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||_unsupported_iterable_to_array(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var s=n(41059),c=(n(2784),n(72779)),l=n(13980),p=n.n(l),h=n(60568);p().oneOfType([p().func,p().object]),p().func,p().func,p().func,p().func,p().func,p().string,p().func,p().any;var f=n(30733),y=n.n(f);n(77105);var g={flagUseNewOverviewPage:"flagUseNewOverviewPage"},m=y()(function(){return function(e){var t=void 0;try{if(t=window.localStorage.getItem(e))return JSON.parse(t)}catch(e){if("string"==typeof t)return t;return}}("DAGSTER_FLAGS")||[g.flagUseNewOverviewPage]});y()(function(e){return m().includes(e)}),y()(function(e){return new Intl.NumberFormat(e,{minimumFractionDigits:3,maximumFractionDigits:3})}),new Intl.Collator(navigator.language,{sensitivity:"base"}),(0,s.H)({source:function(e){return e.source},target:function(e){return e.target},x:function(e){return e.x},y:function(e){return e.y}}),o=(r={source:function(e){return e.source},target:function(e){return e.target},x:function(e){return e.x},y:function(e){return e.y}}).source,i=r.target,a=r.x,u=r.y;var groupIdForNode=function(e){return[e.definition.repository.name,"@",e.definition.repository.location.name,":",e.definition.groupName].join("")},b=y()(function(e,t){var n=Object.keys(t.upstream[JSON.stringify(e.path)]||{}).map(function(e){return{path:JSON.parse(e),__typename:"AssetKey"}});return[e].concat(_to_consumable_array_to_consumable_array(n),_to_consumable_array_to_consumable_array(n.map(function(e){return b(e,t)}).flat())).filter(function(e,t,n){return n.findIndex(function(t){return JSON.stringify(t)===JSON.stringify(e)})===t})},function(e,t){return JSON.stringify({key:e,data:t})}),v={horizontal:{ranker:"tight-tree",direction:"horizontal",marginx:100,marginy:100,ranksep:60,rankdir:"LR",edgesep:90,nodesep:-10,nodeHeight:"auto",groupPaddingTop:65,groupPaddingBottom:-15,groupRendering:"if-varied",clusterpaddingtop:100},vertical:{ranker:"tight-tree",direction:"horizontal",marginx:100,marginy:100,ranksep:20,rankdir:"TB",nodesep:40,edgesep:10,nodeHeight:"auto",groupPaddingTop:55,groupPaddingBottom:-5,groupRendering:"if-varied"}},layoutAssetGraph=function(e,t){try{return layoutAssetGraphImpl(e,t)}catch(n){try{return layoutAssetGraphImpl(e,_object_spread_props_object_spread_props(_object_spread_object_spread({},t),{overrides:{ranker:"longest-path"}}))}catch(n){return layoutAssetGraphImpl(e,_object_spread_props_object_spread_props(_object_spread_object_spread({},t),{overrides:{ranker:"network-simplex"}}))}}},layoutAssetGraphImpl=function(e,t){var n=new d.graphlib.Graph({compound:!0}),r=Object.assign({},v[t.direction],t.overrides||{});n.setGraph(r),n.setDefaultEdgeLabel(function(){return{}});var shouldRender=function(e){return e},o=Object.values(e.nodes).filter(shouldRender),i=e.expandedGroups||[],a={},u=!0,s=!1,c=void 0;try{for(var l,p=o[Symbol.iterator]();!(u=(l=p.next()).done);u=!0){var h=l.value;if(h.definition.groupName){var f=groupIdForNode(h);a[f]=a[f]||{id:f,expanded:i.includes(f),groupName:h.definition.groupName,repositoryName:h.definition.repository.name,repositoryLocationName:h.definition.repository.location.name,bounds:{x:0,y:0,width:0,height:0}}}}}catch(e){s=!0,c=e}finally{try{u||null==p.return||p.return()}finally{if(s)throw c}}var y="if-varied"!==r.groupRendering||Object.keys(a).length>1;y&&Object.keys(a).forEach(function(e){i.includes(e)?n.setNode(e,{borderType:"borderRight"}):n.setNode(e,{width:_,height:110})}),o.forEach(function(e){if(!y||i.includes(groupIdForNode(e))){var t="auto"===r.nodeHeight?getAssetNodeDimensions(e.definition):{width:_,height:r.nodeHeight};n.setNode(e.id,t),y&&e.definition.groupName&&n.setParent(e.id,groupIdForNode(e))}});var g={},m=Object.fromEntries(Object.entries(e.nodes).map(function(e){var t=_sliced_to_array_sliced_to_array(e,2);return[t[0],groupIdForNode(t[1])]}));Object.entries(e.downstream).forEach(function(t){var r=_sliced_to_array_sliced_to_array(t,2),o=r[0];Object.keys(r[1]).forEach(function(t){if(shouldRender(e.nodes[t])||shouldRender(e.nodes[o])){var r=o,a=t,u=m[t];y&&u&&!i.includes(u)&&(a=u);var d=m[o];y&&d&&!i.includes(d)&&(r=d),r!==a&&(n.setEdge({v:r,w:a},{weight:1}),shouldRender(e.nodes[t])?shouldRender(e.nodes[o])||(g[o]=!0):g[t]=!0)}})}),Object.keys(g).forEach(function(e){var r=JSON.parse(e),o=r[r.length-1]||"";n.setNode(e,getAssetLinkDimensions(o,t))}),d.layout(n);var b=1,x=1,w={};if(n.nodes().forEach(function(e){var t=n.node(e);if((null==t?void 0:t.x)&&(null==t?void 0:t.width)){var r={x:t.x-t.width/2,y:t.y-t.height/2,width:t.width,height:t.height};/^[^@:]+@[^@:]+:.+$/.test(e)?i.includes(e)||(a[e].bounds=r):w[e]={id:e,bounds:r},b=Math.max(b,t.x+t.width/2),x=Math.max(x,t.y+t.height/2)}}),y){var O=!0,j=!1,E=void 0;try{for(var N,I=o[Symbol.iterator]();!(O=(N=I.next()).done);O=!0){var k=N.value,S=w[k.id];if(S&&k.definition.groupName){var A=a[groupIdForNode(k)];A.bounds=0===A.bounds.width?S.bounds:extendBounds(A.bounds,S.bounds)}}}catch(e){j=!0,E=e}finally{try{O||null==I.return||I.return()}finally{if(j)throw E}}var P=!0,M=!1,B=void 0;try{for(var D,G=Object.values(a)[Symbol.iterator]();!(P=(D=G.next()).done);P=!0){var z=D.value;z.expanded&&(z.bounds=padBounds(z.bounds,{x:15,top:r.groupPaddingTop,bottom:r.groupPaddingBottom}))}}catch(e){M=!0,B=e}finally{try{P||null==G.return||G.return()}finally{if(M)throw B}}}var R=[];return n.edges().forEach(function(e){var r=n.node(e.v),o=n.node(e.w);if(r&&o){var i=g[e.v]?16:24,a=g[e.w]?16:24;R.push("horizontal"===t.direction?{from:{x:r.x+r.width/2,y:r.y},fromId:e.v,to:{x:o.x-o.width/2-5,y:o.y},toId:e.w}:{from:{x:r.x-r.width/2+i,y:r.y-30+r.height/2},fromId:e.v,to:{x:o.x-o.width/2+a,y:o.y+20-o.height/2},toId:e.w})}}),{nodes:w,edges:R,width:b+100,height:x+100,groups:y?a:{}}},getAssetLinkDimensions=function(e,t){return"horizontal"===t.direction?{width:32+7.1*Math.min(30,e.length),height:50}:{width:106,height:50}},padBounds=function(e,t){return{x:e.x-t.x,y:e.y-t.top,width:e.width+2*t.x,height:e.height+t.top+t.bottom}},extendBounds=function(e,t){var n=Math.min(e.x,t.x),r=Math.min(e.y,t.y);return{x:n,y:r,width:Math.max(e.x+e.width,t.x+t.width)-n,height:Math.max(e.y+e.height,t.y+t.height)-r}},_=320,getAssetNodeDimensions=function(e){var t,n=100;return e.isSource&&e.isObservable?n+=30:(n+=26,e.isPartitioned&&(n+=40)),(null===(t=e.changedReasons)||void 0===t?void 0:t.length)&&(n+=30),{width:_,height:n+=30}},titleOfIO=function(e){return"result"!==e.solid.name?"".concat(e.solid.name,":").concat(e.definition.name):e.solid.name};function flattenIO(e){var t={};return e.forEach(function(e){return e.forEach(function(e){return t[titleOfIO(e)]=e})}),Object.values(t)}function layoutExternalConnections(e,t,n){var r=n-166,o=Math.max(200,r/e.length),i=83+Math.min(0,(r-e.length*o)/2),a=o<300?20:0,u={};return e.forEach(function(e,n){u[titleOfIO(e)]={x:i+n*o,y:t+a*(1-n%2*2)}}),u}function layoutOp(e,t){var n=t.y,appendMiniIODots=function(e,r,o){var i,a=_to_consumable_array_to_consumable_array(e).sort(function(e,t){return r(e).localeCompare(r(t))}),u=0,d=null,s={},c=Math.min(35,370/(a.length+1));a.forEach(function(e,r){var a=o(e);a!==d?(d=a,i={port:{x:t.x+u+13,y:n+13},collapsed:[],label:!1,layout:{x:t.x+u,y:n,width:35,height:26}},s[e.definition.name]=i,u+=c):(0===i.collapsed.length&&(u+=15),i.collapsed.push(e.definition.name))});var l=(370-(u-13+35))/2;return Object.values(s).forEach(function(e){e.layout.x+=l,e.port.x+=l}),n+=26,s},appendStackedIOBoxes=function(e){var r={};return e.forEach(function(e){r[e.definition.name]={port:{x:t.x+13,y:n+13},label:!0,collapsed:[],layout:{x:t.x,y:n,width:0,height:26}},n+=26}),r},r=e.inputs.length>4?appendMiniIODots(e.inputs,function(e){return e.definition.name},function(e){var t;return(null===(t=e.dependsOn[0])||void 0===t?void 0:t.solid.name)||""}):appendStackedIOBoxes(e.inputs),o={x:t.x,y:Math.max(t.y,n-0),width:370,height:52};n+=52,e.definition.assetNodes.length&&e.definition.description&&(o.height+=22,n+=22);var i=e.outputs.length>4?appendMiniIODots(e.outputs,function(e){var t;return(null===(t=e.dependedBy[0])||void 0===t?void 0:t.definition.name)||""},function(e){var t;return(null===(t=e.dependedBy[0])||void 0===t?void 0:t.solid.name)||""}):appendStackedIOBoxes(e.outputs);return{bounds:{x:t.x-5,y:t.y-5,width:380,height:n-t.y+10},op:o,inputs:r,outputs:i}}self.addEventListener("message",function(e){var t=e.data;switch(t.type){case"layoutOpGraph":var n,r,o,i,a,u,s,c,l,p,h,f,y,g,m,b=t.ops,v=t.opts;self.postMessage((a=new d.graphlib.Graph,u=0,s=100,c=100,v.parentOp&&(s=(c=140)+(u=26*Math.max(v.parentOp.inputs.length,v.parentOp.outputs.length))),a.setGraph({rankdir:"TB",marginx:c,marginy:s,ranker:"tight-tree"}),a.setDefaultEdgeLabel(function(){return{}}),l=[],p={},b.forEach(function(e){p[e.name]=!0}),b.forEach(function(e){var t=layoutOp(e,{x:0,y:0});a.setNode(e.name,{width:t.bounds.width,height:t.bounds.height}),e.inputs.forEach(function(t){t.dependsOn.forEach(function(n){p[n.solid.name]&&p[e.name]&&(a.setEdge({v:n.solid.name,w:e.name},{weight:1}),l.push({from:{point:{x:0,y:0},opName:n.solid.name,edgeName:n.definition.name},to:{point:{x:0,y:0},opName:e.name,edgeName:t.definition.name}}))})})}),d.layout(a),h={},f={},a.nodes().forEach(function(e){var t=a.node(e);t&&(f[e]=t)}),y=0,g=0,Object.entries(f).forEach(function(e){var t=_sliced_to_array_sliced_to_array(e,2),n=t[0],r=t[1],o=b.find(function(e){return e.name===n});if(o){var i=r.x-r.width/2,a=r.y-r.height/2;h[n]=layoutOp(o,{x:i,y:a}),y=Math.max(y,i+r.width),g=Math.max(g,a+r.height)}}),a.edges().forEach(function(e){var t=l.find(function(t){return t.from.opName===e.v&&t.to.opName===e.w}),n=a.edge(e).points;t&&n.length>0&&(t.from.point=n[0],t.to.point=n[n.length-1])}),m={edges:l,nodes:h,width:y+c,height:g+s,parent:null},v.parentOp&&(m.parent=(n=v.parentOp,r=u,i=(o={invocationBoundingBox:{x:1,y:1,width:m.width-1,height:m.height-1},bounds:{x:70,y:70+r,width:m.width-140,height:m.height-(70+r)*2},mappingLeftEdge:50,mappingLeftSpacing:10,inputs:{},outputs:{},dependsOn:layoutExternalConnections(flattenIO(n.inputs.map(function(e){return e.dependsOn})),-50,m.width),dependedBy:layoutExternalConnections(flattenIO(n.outputs.map(function(e){return e.dependedBy})),m.height+50,m.width)}).bounds.y+o.bounds.height,n.inputs.forEach(function(e,t){o.inputs[e.definition.name]={layout:{x:o.bounds.x,y:o.bounds.y-26*t-26,width:0,height:26},collapsed:[],label:!0,port:{x:o.bounds.x+13,y:o.bounds.y-26*t-13}}}),n.outputs.forEach(function(e,t){o.outputs[e.definition.name]={layout:{x:o.bounds.x,y:i+26*t,width:0,height:26},collapsed:[],label:!0,port:{x:o.bounds.x+13,y:i+26*t+13}}}),o)),m));break;case"layoutAssetGraph":var _=t.graphData,x=t.opts;self.postMessage(layoutAssetGraph(_,x))}})}}]);
//# sourceMappingURL=1582.a454fc3205078df2.js.map