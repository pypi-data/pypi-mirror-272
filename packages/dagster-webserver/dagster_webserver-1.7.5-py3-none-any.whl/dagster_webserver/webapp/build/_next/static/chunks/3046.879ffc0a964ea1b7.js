"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3046],{84022:function(e,n,t){t.d(n,{C:function(){return RepoFilterButton}});var r=t(58467),o=t(52322),i=t(10952),s=t(18399),a=t(9001),c=t(67486),l=t(2784),u=t(75690),d=t(46988),RepoFilterButton=function(){var e=(0,l.useContext)(d.C5),n=e.allRepos,t=e.visibleRepos,p=e.toggleVisible,h=(0,r._)((0,l.useState)(!1),2),x=h[0],f=h[1];return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(i.Vq,{canOutsideClickClose:!0,canEscapeKeyClose:!0,isOpen:x,style:{width:"auto"},onClose:function(){return f(!1)},children:[(0,o.jsx)(i.fK,{icon:"repo",label:"Filter code locations"}),(0,o.jsx)(u.e,{options:n,onBrowse:function(){return f(!1)},onToggle:p,selected:t}),(0,o.jsx)(i.cN,{children:(0,o.jsx)(s.x,{padding:{top:8},children:(0,o.jsx)(a.zx,{intent:"none",onClick:function(){return f(!1)},children:"Done"})})})]}),(0,o.jsx)(a.zx,{outlined:!0,icon:(0,o.jsx)(c.JO,{name:"folder"}),rightIcon:(0,o.jsx)(c.JO,{name:"expand_more"}),onClick:function(){return f(!0)},children:"".concat(t.length," of ").concat(n.length)})]})}},9445:function(e,n,t){t.d(n,{e:function(){return JobsPageContent}});var r=t(58467),o=t(73235),i=t(52322),s=t(40794),a=t(89130),c=t(18399),l=t(63832),u=t(25195),d=t(92364),p=t(34822),h=t(25557),x=t(2784),f=t(91195),m=t(55237),j=t(35157),b=t(71277),v=t(84022),g=t(43180),y=t(57830),w=t(88510),J=t(68884),_=t(55658),R=t(77277),C=t(42885),E=t(9901),S=t(41256),O=t(44254),OverviewJobsTable=function(e){var n=e.repos,t=(0,x.useRef)(null),r=(0,x.useMemo)(function(){return n.map(function(e){var n=e.repoAddress;return(0,O.Uz)(n)})},[n]),o=(0,C.N)(J.y,r),s=o.expandedKeys,a=o.onToggle,c=o.onToggleAll,l=(0,x.useMemo)(function(){var e=[];return n.forEach(function(n){var t=n.repoAddress,r=n.jobs;e.push({type:"header",repoAddress:t,jobCount:r.length});var o=(0,O.Uz)(t);s.includes(o)&&r.forEach(function(n){var r=n.isJob,o=n.name;e.push({type:"job",repoAddress:t,isJob:r,name:o})})}),e},[n,s]),u=(0,R.w)(n.map(function(e){return e.repoAddress.name})),d=(0,w.MG)({count:l.length,getScrollElement:function(){return t.current},estimateSize:function(e){var n=l[e];return(null==n?void 0:n.type)==="header"?_.lo:64},overscan:10}),p=d.getTotalSize(),h=d.getVirtualItems();return(0,i.jsx)("div",{style:{overflow:"hidden"},children:(0,i.jsxs)(_.W2,{ref:t,children:[(0,i.jsx)(E.I,{}),(0,i.jsx)(_.Nh,{$totalHeight:p,children:h.map(function(e){var n=e.index,t=e.key,r=e.size,o=e.start,d=l[n];return"header"===d.type?(0,i.jsx)(S.vG,{repoAddress:d.repoAddress,height:r,start:o,onToggle:a,onToggleAll:c,expanded:s.includes((0,O.Uz)(d.repoAddress)),showLocation:u.has(d.repoAddress.name),rightElement:(0,i.jsx)(g.u,{content:1===d.jobCount?"1 job":"".concat(d.jobCount," jobs"),placement:"top",children:(0,i.jsx)(y.V,{children:d.jobCount})})},t):(0,i.jsx)(E.b,{name:d.name,isJob:d.isJob,repoAddress:d.repoAddress,height:r,start:o},t)})})]})})},N=t(44392),A=t(89191),k=t(58298),L=t(46988),P=t(37160);function _templateObject(){var e=(0,o._)(["\n  query OverviewJobsQuery {\n    workspaceOrError {\n      ... on Workspace {\n        id\n        locationEntries {\n          id\n          locationOrLoadError {\n            ... on RepositoryLocation {\n              id\n              name\n              repositories {\n                id\n                name\n                pipelines {\n                  id\n                  name\n                  isJob\n                }\n              }\n            }\n            ...PythonErrorFragment\n          }\n        }\n      }\n      ...PythonErrorFragment\n    }\n  }\n\n  ","\n"]);return _templateObject=function(){return e},e}var JobsPageContent=function(){var e=(0,x.useContext)(L.C5),n=e.allRepos,t=e.visibleRepos,o=e.loading,a=(0,r._)((0,b.q)({queryKey:"search",defaults:{search:""}}),2),f=a[0],j=a[1],g=n.length,y=(0,s.a)(z,{fetchPolicy:"network-only",notifyOnNetworkStatusChange:!0}),w=y.data,J=y.loading,_=(0,m.C4)(y,m.dT),R=(0,x.useMemo)(function(){var e=(0,A.S)(t);return buildBuckets(w).filter(function(n){var t=n.repoAddress;return e.has((0,O.Uz)(t))})},[w,t]),C=f.trim().toLocaleLowerCase(),E=C.length>0,S=(0,x.useMemo)(function(){var e=C.toLocaleLowerCase();return R.map(function(n){return{repoAddress:n.repoAddress,jobs:n.jobs.filter(function(n){return n.name.toLocaleLowerCase().includes(e)})}}).filter(function(e){return e.jobs.length>0})},[R,C]),N=o&&!g||J&&!w;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(c.x,{padding:{horizontal:24,vertical:16},flex:{direction:"row",alignItems:"center",justifyContent:"space-between",grow:0},children:[(0,i.jsxs)(c.x,{flex:{direction:"row",gap:12,alignItems:"center"},children:[g>1?(0,i.jsx)(v.C,{}):null,(0,i.jsx)(p.oi,{icon:"search",value:f,rightElement:N?(0,i.jsx)(k.W,{tooltipContent:"Loading jobs…"}):void 0,onChange:function(e){return j(e.target.value)},placeholder:"Filter by job name…",style:{width:"340px"}})]}),(0,i.jsx)(m.xi,{refreshState:_})]}),J&&!g?(0,i.jsx)(c.x,{padding:64,children:(0,i.jsx)(h.f,{label:"Loading jobs…"})}):function(){if(J&&!w)return(0,i.jsx)(c.x,{flex:{direction:"row",justifyContent:"center"},style:{paddingTop:"100px"},children:(0,i.jsxs)(c.x,{flex:{direction:"row",alignItems:"center",gap:16},children:[(0,i.jsx)(l.$,{purpose:"body-text"}),(0,i.jsx)("div",{style:{color:u.$()},children:"Loading jobs…"})]})});var e=n.length>t.length;return S.length?(0,i.jsx)(OverviewJobsTable,{repos:S}):E?(0,i.jsx)(c.x,{padding:{top:20},children:(0,i.jsx)(d.t,{icon:"search",title:"No matching jobs",description:e?(0,i.jsxs)("div",{children:["No jobs matching ",(0,i.jsx)("strong",{children:f})," were found in the selected code locations"]}):(0,i.jsxs)("div",{children:["No jobs matching ",(0,i.jsx)("strong",{children:f})," were found in your definitions"]})})}):(0,i.jsx)(c.x,{padding:{top:20},children:(0,i.jsx)(d.t,{icon:"search",title:"No jobs",description:e?"No jobs were found in the selected code locations":"No jobs were found in your definitions"})})}()]})},buildBuckets=function(e){if((null==e?void 0:e.workspaceOrError.__typename)!=="Workspace")return[];var n=e.workspaceOrError.locationEntries.map(function(e){return e.locationOrLoadError}),t=[],r=!0,o=!1,i=void 0;try{for(var s,a=n[Symbol.iterator]();!(r=(s=a.next()).done);r=!0){var c=s.value;if((null==c?void 0:c.__typename)==="RepositoryLocation"){var l=!0,u=!1,d=void 0;try{for(var p,h=c.repositories[Symbol.iterator]();!(l=(p=h.next()).done);l=!0){var x=p.value,f=x.name,m=x.pipelines,b=(0,P.kQ)(f,c.name),v=m.filter(function(e){var n=e.name;return!(0,j.pv)(n)}).map(function(e){return{isJob:e.isJob,name:e.name}});v.length>0&&t.push({repoAddress:b,jobs:v})}}catch(e){u=!0,d=e}finally{try{l||null==h.return||h.return()}finally{if(u)throw d}}}}}catch(e){o=!0,i=e}finally{try{r||null==a.return||a.return()}finally{if(o)throw i}}return(0,N.S)(t)},z=(0,a.Ps)(_templateObject(),f.B)},83046:function(e,n,t){t.r(n),t.d(n,{JobsRoot:function(){return JobsRoot}});var r=t(52322),o=t(18399),i=t(17131),s=t(81308),a=t(9445),c=t(68028),l=t(28252),JobsRoot=function(){return(0,c.Px)(),(0,l.j)("Jobs"),(0,r.jsxs)(o.x,{flex:{direction:"column"},style:{height:"100%",overflow:"hidden"},children:[(0,r.jsx)(i.m,{title:(0,r.jsx)(s.X6,{children:"Jobs"})}),(0,r.jsx)(a.e,{})]})};n.default=JobsRoot},68884:function(e,n,t){t.d(n,{y:function(){return r}});var r="overview-collapsed-state"},44392:function(e,n,t){t.d(n,{S:function(){return sortRepoBuckets}});var r=t(82550),o=t(44254),sortRepoBuckets=function(e){return(0,r._)(e).sort(function(e,n){var t=(0,o.Uz)(e.repoAddress),r=(0,o.Uz)(n.repoAddress);return t.localeCompare(r)})}},89191:function(e,n,t){t.d(n,{S:function(){return visibleRepoKeys}});var r=t(37160),o=t(44254),visibleRepoKeys=function(e){return new Set(e.map(function(e){return(0,o.Uz)((0,r.kQ)(e.repository.name,e.repositoryLocation.name))}))}},58298:function(e,n,t){t.d(n,{W:function(){return SearchInputSpinner}});var r=t(52322),o=t(58467),i=t(2784),useDelayedState=function(e){var n=(0,o._)((0,i.useState)(!1),2),t=n[0],r=n[1];return(0,i.useEffect)(function(){var n=setTimeout(function(){return r(!0)},e);return function(){return clearTimeout(n)}},[e]),t},s=t(18399),a=t(43180),c=t(63832),SearchInputSpinner=function(e){var n=e.tooltipContent;return useDelayedState(2e3)?(0,r.jsx)(s.x,{margin:{top:1},children:(0,r.jsx)(a.u,{placement:"top",canShow:!!n,content:n||"",children:(0,r.jsx)(c.$,{purpose:"body-text"})})}):null}},77277:function(e,n,t){t.d(n,{w:function(){return findDuplicateRepoNames}});var findDuplicateRepoNames=function(e){var n=new Set,t=new Set;return e.forEach(function(e){n.has(e)?t.add(e):n.add(e)}),t}},42885:function(e,n,t){t.d(n,{N:function(){return useRepoExpansionState}});var r=t(58467),o=t(2784),i=t(34263),s=t(15282),a=t(44254),validateExpandedKeys=function(e){return Array.isArray(e)?e:[]},useRepoExpansionState=function(e,n){var t,c=(t=(0,o.useContext)(i.I).basePath,"".concat(t,":dagster.").concat(e)),l=(0,r._)((0,s.U)(c,validateExpandedKeys),2),u=l[0],d=l[1],p=(0,o.useCallback)(function(e){var n="object"==typeof e?(0,a.Uz)(e):e;d(function(e){var t=new Set(e||[]);return t.has(n)?t.delete(n):t.add(n),Array.from(t)})},[d]),h=(0,o.useCallback)(function(e){d(function(t){var r=new Set(t||[]);return n.forEach(function(n){e?r.delete(n):r.add(n)}),Array.from(r)})},[n,d]),x=(0,o.useMemo)(function(){var e=new Set(u);return n.filter(function(n){return!e.has(n)})},[n,u]);return(0,o.useMemo)(function(){return{expandedKeys:x,onToggle:p,onToggleAll:h}},[x,p,h])}},9901:function(e,n,t){t.d(n,{I:function(){return VirtualizedJobHeader},b:function(){return VirtualizedJobRow}});var r=t(58467),o=t(73235),i=t(82550),s=t(52322),a=t(83601),c=t(89130),l=t(16861),u=t(18399),d=t(2784),p=t(47933),h=t(35505),x=t(41256),f=t(46988),m=t(38153),j=t(55237),b=t(44678),v=t(63832),g=t(37783),y=t(43180),w=t(9001),J=t(67486),_=t(54949),R=t(185),C=t(18960),E=t(61935),S=t(95388),O=t(94370),N=t(5035);function _templateObject(){var e=(0,o._)(["\n  query RunReExecutionQuery($runId: ID!) {\n    pipelineRunOrError(runId: $runId) {\n      ... on Run {\n        id\n        status\n        pipelineName\n        executionPlan {\n          artifactsPersisted\n          ...ExecutionPlanToGraphFragment\n        }\n      }\n    }\n  }\n  ","\n"]);return _templateObject=function(){return e},e}var JobMenu=function(e){var n=e.job,t=e.isAssetJob,o=e.repoAddress,i=n.runs.length?n.runs[0]:null,c={pipelineName:n.name,repositoryName:o.name,repositoryLocationName:o.location},l=(0,R.DO)(n.name),u=(0,O.D)(),p=(0,_.xz)(o.location),h=p.permissions,x=h.canLaunchPipelineReexecution,f=h.canLaunchPipelineExecution,j=p.disabledReasons,C=(0,r._)((0,a.t)(A),2),k=C[0],L=C[1].data,P=(0,d.useCallback)(function(){(null==i?void 0:i.id)&&k({variables:{runId:i.id}})},[i,k]),z=(null==L?void 0:L.pipelineRunOrError.__typename)==="Run"?null==L?void 0:L.pipelineRunOrError:null,T="loading"===t?(0,s.jsx)(b.sN,{icon:"execute",text:"Loading...",disabled:!0}):!0===t?(0,s.jsx)(b.sN,{icon:l.loading?(0,s.jsx)(v.$,{purpose:"caption-text"}):"execute",text:"Launch new run",disabled:!f,onClick:function(e){return l.onClick(c,e)}}):(0,s.jsx)(N.U,{icon:"execute",text:"Launch new run",disabled:!f,to:(0,m.jT)({repoName:o.name,repoLocation:o.location,pipelineName:n.name,isJob:n.isJob,path:"/playground"})}),I=(0,s.jsx)(b.sN,{icon:"replay",text:"Re-execute latest run",onClick:function(){return z?u(z,E.hmq.ALL_STEPS):void 0},disabled:!x||!z||!(0,S.EP)(z)}),q=(0,s.jsx)(b.sN,{icon:"sync_problem",text:"Re-execute latest run from failure",onClick:function(){return z?u(z,E.hmq.FROM_FAILURE):void 0},disabled:!x||!z||!(0,S.VM)(z)});return(0,s.jsxs)(s.Fragment,{children:[l.launchpadElement,(0,s.jsx)(g.J,{onOpened:function(){return P()},content:(0,s.jsxs)(b.v2,{children:[(0,s.jsx)(N.U,{to:(0,m.jT)({repoName:o.name,repoLocation:o.location,pipelineName:n.name,isJob:n.isJob}),icon:"job",text:"View job"}),(0,s.jsx)(N.U,{to:(0,m.jT)({repoName:o.name,repoLocation:o.location,pipelineName:n.name,isJob:n.isJob,path:"/runs"}),icon:"checklist",text:"View all recent runs"}),f?T:(0,s.jsx)(y.u,{content:j.canLaunchPipelineExecution,display:"block",children:T}),x?I:(0,s.jsx)(y.u,{content:j.canLaunchPipelineReexecution,display:"block",children:I}),x?q:(0,s.jsx)(y.u,{content:j.canLaunchPipelineReexecution,display:"block",children:q})]}),position:"bottom-left",children:(0,s.jsx)(w.zx,{icon:(0,s.jsx)(J.JO,{name:"expand_more"})})})]})},A=(0,c.Ps)(_templateObject(),C.$),k=t(17212),L=t(12518),P=t(98349),z=t(38917),T=t(66207),I=t(23054),q=t(55658);function VirtualizedJobRow_templateObject(){var e=(0,o._)(["\n  display: grid;\n  grid-template-columns: ",";\n  height: 100%;\n"]);return VirtualizedJobRow_templateObject=function(){return e},e}function _templateObject1(){var e=(0,o._)(["\n  width: 100%;\n\n  > .bp4-popover2-target {\n    width: 100%;\n  }\n"]);return _templateObject1=function(){return e},e}function _templateObject2(){var e=(0,o._)(["\n  query SingleJobQuery($selector: PipelineSelector!) {\n    pipelineOrError(params: $selector) {\n      ... on Pipeline {\n        id\n        name\n        isJob\n        isAssetJob\n        description\n        runs(limit: 5) {\n          id\n          ...RunTimeFragment\n        }\n        schedules {\n          id\n          ...ScheduleSwitchFragment\n        }\n        sensors {\n          id\n          ...SensorSwitchFragment\n        }\n      }\n    }\n  }\n\n  ","\n  ","\n  ","\n"]);return _templateObject2=function(){return e},e}var U="1.5fr 1fr 180px 96px 80px",VirtualizedJobRow=function(e){var n=e.name,t=e.isJob,o=e.repoAddress,c=e.start,h=e.height,b=(0,r._)((0,a.t)($,{variables:{selector:(0,f._T)(o,n)}}),2),v=b[0],g=b[1];(0,x.v5)(v),(0,j.C4)(g,j.dT);var y=g.data,w=(null==y?void 0:y.pipelineOrError.__typename)==="Pipeline"?null==y?void 0:y.pipelineOrError:void 0,J=(0,d.useMemo)(function(){return w?{schedules:w.schedules,sensors:w.sensors}:{schedules:[],sensors:[]}},[w]),_=J.schedules,R=J.sensors,C=(0,d.useMemo)(function(){if(w){var e=w.runs;if(e.length)return(0,i._)(e)}return[]},[w]);return(0,s.jsx)(q.X2,{$height:h,$start:c,children:(0,s.jsxs)(F,{border:"bottom",children:[(0,s.jsxs)(q.E5,{children:[(0,s.jsx)("div",{style:{maxWidth:"100%",whiteSpace:"nowrap",fontWeight:500},children:(0,s.jsx)(p.rU,{to:(0,m.$U)(o,"/jobs/".concat(n)),children:(0,s.jsx)(l.g,{text:n})})}),(0,s.jsx)(x.HB,{children:(null==w?void 0:w.description)||""})]}),(0,s.jsx)(q.E5,{children:_.length||R.length?(0,s.jsx)(u.x,{flex:{direction:"column",alignItems:"flex-start",gap:8},children:(0,s.jsx)(V,{children:(0,s.jsx)(L.I,{schedules:_,sensors:R,repoAddress:o})})}):(0,s.jsx)(x.mq,{queryResult:g})}),(0,s.jsx)(q.E5,{children:C[0]?(0,s.jsx)(k.Z,{run:C[0],showButton:!1,showHover:!0,showSummary:!1,name:n}):(0,s.jsx)(x.mq,{queryResult:g})}),(0,s.jsx)(q.E5,{children:C.length?(0,s.jsx)(u.x,{padding:{top:4},children:(0,s.jsx)(P.JH,{jobName:n,runs:(0,i._)(C).reverse(),fade:!0})}):(0,s.jsx)(x.mq,{queryResult:g})}),(0,s.jsx)(q.E5,{children:(0,s.jsx)(u.x,{flex:{justifyContent:"flex-end"},style:{marginTop:"-2px"},children:(0,s.jsx)(JobMenu,{job:{name:n,isJob:t,runs:C},isAssetJob:w?w.isAssetJob:"loading",repoAddress:o})})})]})})},VirtualizedJobHeader=function(){return(0,s.jsxs)(q.VJ,{templateColumns:U,sticky:!0,children:[(0,s.jsx)(q.qN,{children:"Name"}),(0,s.jsx)(q.qN,{children:"Schedules/sensors"}),(0,s.jsx)(q.qN,{children:"Latest run"}),(0,s.jsx)(q.qN,{children:"Run history"}),(0,s.jsx)(q.qN,{})]})},F=(0,h.ZP)(u.x).withConfig({componentId:"sc-8e22c81e-0"})(VirtualizedJobRow_templateObject(),U),V=h.ZP.div.withConfig({componentId:"sc-8e22c81e-1"})(_templateObject1()),$=(0,c.Ps)(_templateObject2(),z.$X,T.J,I.U)}}]);
//# sourceMappingURL=3046.879ffc0a964ea1b7.js.map