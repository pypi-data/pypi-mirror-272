"use strict";(self.webpackChunk_jupytercad_jupytercad_lab=self.webpackChunk_jupytercad_jupytercad_lab||[]).push([[484],{484:(e,t,a)=>{a.r(t),a.d(t,{default:()=>m});var o=a(991),r=a(661),d=a(626),n=a(366),s=a(265),i=a(796),l=a(702),c=a(861),u=a(230),p=a(256),g=a(78);class y extends g.JupyterYModel{}class h extends p.Panel{constructor(e){super(),this.onResize=()=>{this._jcadWidget&&u.MessageLoop.sendMessage(this._jcadWidget,p.Widget.ResizeMessage.UnknownSize)},this.addClass("jupytercad-notebook-widget"),this._jcadWidget=new o.JupyterCadPanel(e),this.addWidget(this._jcadWidget)}}const M={id:"jupytercad:yjswidget-plugin",autoStart:!0,requires:[r.IJCadWorkerRegistryToken],optional:[g.IJupyterYWidgetManager,s.ITranslator],activate:(e,t,a,o)=>{if(!a)return void console.error("Missing IJupyterYWidgetManager token!");const d=null!=o?o:s.nullTranslator;a.registerWidget("@jupytercad:widget",class extends y{ydocFactory(t){const{path:a,format:o,contentType:n}=t;this.jupyterCADModel=new r.JupyterCadModel({});const s=e.serviceManager.user;if(a&&o&&n){const e=c.ServerConnection.makeSettings(),t=l.URLExt.join(e.wsUrl,"api/collaboration/room"),r=new i.WebSocketProvider({url:t,path:a,format:o,contentType:n,model:this.jupyterCADModel.sharedModel,user:s,translator:d.load("jupyterlab")});this.jupyterCADModel.disposed.connect((()=>{r.dispose()}))}else{const e=this.jupyterCADModel.sharedModel.awareness,t=t=>{e.setLocalStateField("user",t.identity)};s.ready.then((()=>{t(s)})).catch((e=>console.error(e))),s.userChanged.connect(t,this)}return this.jupyterCADModel.sharedModel.ydoc}},class{constructor(e,a){this.yModel=e,this.node=a;const o=new h({model:e.jupyterCADModel,workerRegistry:t});u.MessageLoop.sendMessage(o,p.Widget.Msg.BeforeAttach),a.appendChild(o.node),u.MessageLoop.sendMessage(o,p.Widget.Msg.AfterAttach)}})}},C="jupytercad",m=[{id:"jupytercad:lab:main-menu",autoStart:!0,requires:[r.IJupyterCadDocTracker,r.IJCadFormSchemaRegistryToken],optional:[n.IMainMenu,s.ITranslator],activate:(e,t,a,r,d)=>{console.log("jupytercad:lab:main-menu is activated!"),d=null!=d?d:s.nullTranslator;(0,o.addCommands)(e,t,d,a),r&&function(e,t){e.fileMenu.addItem({command:o.CommandIDs.exportJcad}),e.editMenu.undoers.redo.add({id:o.CommandIDs.redo,isEnabled:t}),e.editMenu.undoers.undo.add({id:o.CommandIDs.undo,isEnabled:t})}(r,(()=>null!==t.currentWidget&&t.currentWidget===e.shell.currentWidget))}},{id:"jupytercad:lab:controlpanel",autoStart:!0,requires:[d.ILayoutRestorer,r.IJupyterCadDocTracker,r.IAnnotationToken,r.IJCadFormSchemaRegistryToken],activate:(e,t,a,r,d)=>{const n=new o.ControlPanelModel({tracker:a}),s=new o.LeftPanelWidget({model:n,annotationModel:r,tracker:a});s.id="jupytercad::leftControlPanel",s.title.caption="JupyterCad Control Panel",s.title.icon=o.jcLightIcon;const i=new o.RightPanelWidget({model:n,formSchemaRegistry:d});i.id="jupytercad::rightControlPanel",i.title.caption="JupyterCad Control Panel",i.title.icon=o.jcLightIcon,t&&(t.add(s,C),t.add(i,C)),e.shell.add(s,"left",{rank:2e3}),e.shell.add(i,"right",{rank:2e3})}},M]}}]);